var _slicedToArray=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],o=!0,i=!1,a=void 0;try{for(var r,s=e[Symbol.iterator]();!(o=(r=s.next()).done)&&(n.push(r.value),!t||n.length!==t);o=!0);}catch(e){i=!0,a=e}finally{try{!o&&s.return&&s.return()}finally{if(i)throw a}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")};function _defineProperty(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}define("platform/bi/events.json",[],function(){return{CONTROLLER_GFPP_CLICK:{evid:26,src:79,endpoint:"platform",fields:{app_name:"string",action_name:"string",controller_type:"string",component_id:"string",pageId:"string"}},page_delete_dataset:{evid:91,src:79,endpoint:"platform",fields:{app_name:"string",controller_type:"string",component_id:"string",pageId:"string"}}}}),define("platform/appController/controllerSettingsGfpp",["lodash","platformEvents","constants","platform/bi/events.json","experiment"],function(f,u,e,m,s){"use strict";var o={dataset:"7f921134-acd3-4771-ac24-33bbeafefb90",router_dataset:"7f921134-acd3-4771-ac24-33bbeafefb90"},i="gfpp_mainaction_dataset",g={MAIN_ACTION1:"mainAction1",MAIN_ACTION2:"mainAction2",DEPRECATED_MAIN_ACTION:"mainAction"},t={untranslatable:!0,mainActions:function(e,t){var n=[],o=e.platform.controllers.getStageData(f.head(t));if(s.isOpen("se_dataBindingOutOfDevMode")){var i=f.get(o,["gfpp",g.MAIN_ACTION1])?g.MAIN_ACTION1:g.DEPRECATED_MAIN_ACTION,a=f.get(o,["gfpp",i]),r=f.get(o,["gfpp",g.MAIN_ACTION2]);a&&n.push(p(i,o)),r&&n.push(p(g.MAIN_ACTION2,o))}else n.push(p(g.DEPRECATED_MAIN_ACTION,o));return n},presetActions:{help:{helpId:function(e,t){var n=e.components.data.get(t).controllerType;return o[n]||"3c9b0528-699b-475f-818c-2123885cb11f"}}},enabledActions:[e.ROOT_COMPS.GFPP.ACTIONS.HELP]};function p(e,t){var n=P(e,t);return{label:n,shouldTranslate:n===i,onClick:f.partial(a,e)}}function P(e,t){var n=f.get(t,"gfpp."+e+".label");return f.isNil(n)?i:n}function a(e,t,n){var o=f.head(n),i=t.components.data.get(o),a=t.dsRead.platform.controllers.settings.get(o),r=t.dsRead.platform.controllers.getName(o),s=t.platform.controllers.getStageData(f.head(n));t.bi.event(m.CONTROLLER_GFPP_CLICK,{action_name:P(e,s),app_name:i.applicationId,controller_type:i.controllerType,component_id:o.id,pageId:t.pages.getCurrentPageId()});var p=t.dsRead.platform.getAppDataByAppDefId(i.applicationId),l={controllerRef:o,controllerConfig:a,controllerType:i.controllerType,controllerDisplayName:r,origin:"gfpp"},c=void 0;if(e===g.DEPRECATED_MAIN_ACTION)c=u.factory.controllerSettingsButtonClicked(l);else{var d=f.get(s,"gfpp."+e+".actionId");c=u.factory.controllerGfppClicked(f.assign(l,{id:d}))}t.dsActions.platform.notifyApplication(p.applicationId,c)}return{init:function(e){e("AppController",t)}}}),define("platform/services/platformConnectedGfpp",["lodash","gfppData","experiment","constants"],function(d,f,s,e){"use strict";var u=e.ROOT_COMPS.GFPP.ACTIONS,p="DEFAULT",l="HIDE",m=[u.SETTINGS,u.LAYOUT,u.DESIGN,u.UPGRADE],c={desktop:[u.MANAGE,u.BACKGROUND,u.SETTINGS,u.LINK,u.LAYOUT,u.DESIGN,u.CUSTOMIZE_DESIGN,u.APPLY_TO_OTHER_VIEW,u.CROP,u.FILTERS,u.EFFECTS,u.ANIMATION,u.AVIARY,u.STRETCH,u.STRETCH_FOR_COLUMNS,u.UPGRADE,u.HELP,u.CONNECT,u.PIN_MODE],mobile:[u.MANAGE,u.SCALE_UP,u.SCALE_DOWN,u.SETTINGS,u.LAYOUT,u.DESIGN,u.CUSTOMIZE_DESIGN,u.APPLY_TO_OTHER_VIEW,u.CROP,u.FILTERS,u.EFFECTS,u.ANIMATION,u.AVIARY,u.STRETCH,u.UPGRADE,u.HIDE,u.HELP]},g=[u.HELP,u.HIDE],P="advancedStylePanel.multiComponentAdvancedStylePanel";function A(e,t){return"mobile"===e?(o=t,n=d.has(o,"textSize")?d.assign({},o,{scale_up:o.textSize,scale_down:o.textSize}):d.omit(o,["scale_up","scale_down"]),d.has(n,u.ANIMATION)?d(n).omit([u.ANIMATION]).assign(_defineProperty({},u.MOBILE_ANIMATION,n[u.ANIMATION])).value():n):t;var n,o}function I(e,s,t,n){if(d.isEmpty(e.groupMapping))return o=s,i=e.title,a=t,void o.panelManager.openComponentPanel(P,{selectedComponent:[],groupMapping:{},title:i,keyByComp:{},onPresetChanged:a,shouldTranslate:!1},!0);var o,i,a,r=s.dsRead.platform.controllers.getStageData(n).connections,p=d.pickBy(r,"designMapping"),l=s.dsRead.platform.controllers.connections.getConnectedComponents(n).reduce(function(e,t){var n,o,i=(n=t,o=s.dsRead.platform.controllers.connections.getPrimaryConnection(n),d.get(o,"role")),a=s.dsRead.components.getType(t),r=d.get(p,[i,"designMapping",a]);return r&&(e[t.id]=r),e},{});s.panelManager.openComponentPanel(P,{groupMapping:e.groupMapping,presets:e.presets,title:e.title,presetsTitle:e.presetsTitle,onPresetChanged:t,designMapping:l,customHelpId:e.customHelpId||e.helpId,presetHelpId:e.presetHelpId||e.helpId,shouldTranslate:!1},!0)}return{generateMainActions:function(e,t,n,o){var i=[d.get(t,[e,"mainAction1"]),d.get(t,[e,"mainAction2"])],a="desktop"===e?n.mainActions:n.mobileMainActions,r=d(i).map(function(e,t){return d.isObject(e)?d(e).omit(["actionId"]).assign({onClick:function(){o(e)},shouldTranslate:!1}).value():(n=e)&&n!==p?null:d.get(a,[t]);var n}).compact().value();return"desktop"===e&&d.isEmpty(r)?d.take(n.mainActions,1):r},generateIconButtonsOverride:function(e,t,n,o,i,a){var r=A(e,d.get(t,[e,"iconButtons"])),s=d(r).pickBy(function(e,t){return d.has(e,"actionId")&&d.includes(m,t)}).mapValues(function(e,t){return{isSelected:function(e){return e.panelManager.findPlatformPanelByType(t)},onClick:function(){o(e)}}}).value(),p=d.get(t,[e,"helpId"]);p&&d.set(s,["help","desktop"===e?"helpId":"mobileHelpId"],p);var l=d.get(t,[e,"globalDesign"]);if(l){var c={isSelected:f.utils.getPanelStateFn(P),onClick:function(e){return I(l,e,i,a)}};d.set(s,u.DESIGN,c)}return d.assign({},n.presetActions,s)},generateEnabledActions:function(e,t,n){var o=A(e,d.get(t,[e,"iconButtons"])),i=c[e];if(d.get(t,[e,"globalDesign"])&&n.push(u.DESIGN),d.isEmpty(o))return d.pull(n,u.UPGRADE);var a=d.filter(n,function(e){var t=o[e];return e===u.UPGRADE?s.isOpen("se_platformPremiumGfpp")&&t===p||d.isObject(t):d.includes(g,e)||t!==l}),r=d.filter(i,function(e){var t=d.includes(m,e)&&o[e]&&d.isObject(o[e]),n=d.includes(a,e);return t||n});return d.forEach(m,function(e){if(o[e]&&d.isObject(o[e])&&!d.includes(n,e)){var t=r.indexOf(e);a.splice(t,0,e)}}),a}}}),define("platform/utils/upgradeUtils",["lodash","stateManagement","util"],function(e,o,n){"use strict";var i="https://www.wix.com/apps/upgrade",a="GFPP";function r(e,t){return new n.UrlBuilder(i).param("appDefId",t).param("metaSiteId",e.dsRead.generalInfo.getMetaSiteId()).param("pp_origin",a).url()}return{getPremiumUrl:r,getPremiumGfpp:function(n){return{onClick:function(t){if(t.dsRead.generalInfo.isFirstSave())requirejs(["tpa"],function(e){return e.packagePicker.startUpgradeFlow(t,n,!1,{shouldNavigate:!1})});else{window.open(r(t,n),"_blank");var e=t.dsRead.tpa.app.getDataByAppDefId(n);t.store.dispatch(o.tpa.actions.addAppToTrackForUpgrade(e.applicationId))}}}}}}),define("platform/appController/appWidgetGfpp",["lodash","platformEvents","stateManagement","gfppData","platform/services/platformConnectedGfpp","platform/utils/upgradeUtils"],function(u,m,g,P,A,I){"use strict";var v=g.editorPlugins.components.selectors;function t(n,e){var o=u.head(e),t=n.components.getChildren(o),i=_slicedToArray(t,1)[0],a=v.getCompTypeSuffix([i],n.dsRead),r=P.utils.getGfppDataResolver(n,e),s=u.cloneDeep(r(P.getComponentData(a)));s.presetActions=u.mapValues(s.presetActions,function(n){return n.onClick?u.assign({},n,{onClick:function(e,t){n.onClick(e,e.components.getChildren(t))}}):n});var p=u.get(n.platform.controllers.getStageData(o),"gfpp");if(p){var l=g.editorPlugins.mobile.selectors.getDeviceType(n.store.getState()),c=n.components.data.get(o).applicationId,d=n.platform.getAppDataByAppDefId(c).applicationId,f=function(e){var t=e.actionId;n.platform.notifyApplication(d,m.factory.widgetGfppClicked({id:t,componentRef:o}))};s.presetActions=s.presetActions||{},s.presetActions.upgrade=I.getPremiumGfpp(c),"desktop"===l?(s.enabledActions=s.enabledActions||[],s.enabledActions.push("upgrade"),s.mainActions=A.generateMainActions(l,p,s,f),s.enabledActions=A.generateEnabledActions(l,p,r(s.enabledActions))):(s.mobileMainActions=A.generateMainActions(l,p,s,f),s.mobileEnabledActions=A.generateEnabledActions(l,p,r(s.mobileEnabledActions))),s.presetActionsData=A.generateIconButtonsOverride(l,p,s,f,function(e){n.platform.notifyApplication(d,m.factory.globalDesignPresetChanged({preset:e,componentRef:o}))},o)}return s}return{init:function(e){e("AppWidget",t)}}}),define("platform/appController/appController",["lodash","platform/appController/controllerSettingsGfpp","platform/appController/appWidgetGfpp","platform/bi/events.json"],function(s,n,o,i){"use strict";function p(o,e){var i=s.reduce(e,function(e,t){return o.components.is.container(t)?e.concat(t,o.components.get.byAncestor(t)):e.concat(t)},[]),a=void 0;return s.some(i,function(e){var t,n=o.dsRead.platform.controllers.connections.get(e);return!s.isEmpty(n)&&(t=n,a=a||s.keyBy(i,"id"),s(t).map("controllerRef").some(function(e){var t=e.id;return!a[t]&&o.components.getPage(e).id!==o.pages.getMasterPageId()}))})}function a(t,e,n){e=s.isArray(e)?e:[e];var o,i=t.components.isShowOnAllPages(e),a=t.components.isShowOnAllPages(n);function r(e){t.panelManager.openPanel("platform.panels.warnForDisconnectedComponentsPanel",s.assign({undo:t.history.undo},e))}i&&!a&&(o=t,s(e).reduce(function(e,t){return o.components.is.container(t)?e.concat(t,o.components.get.byAncestor(t)):e.concat(t)},[]).some(function(e){return"platform.components.AppController"===o.components.getType(e)}))&&r({controllerComp:!0}),!i&&a&&p(t,e)&&r({connectedComps:!0})}return{init:function(e,t){return n.init(t),o.init(t),e.registerCannotRemovePlugin("platform.components.AppController",function(e,t){var n=e.components.data.get(t);e.bi.event(i.page_delete_dataset,{app_name:n.applicationId,controller_type:n.controllerType,controller_id:t.id,pageId:e.dsRead.pages.getPrimaryPageId()})}.bind(null,e)),e.editorEventRegistry.register(e.editorEventRegistry.constants.events.SET_CONTAINER_BEFORE,a),this}}}),define("platform/common/constants",["constants"],function(e){"use strict";return{EDITOR_API_NS:"editorAPI",PLATFORM_PANEL:"PLATFORM_PANEL",PLATFORM_ON_EVENT:"PLATFORM_ON_EVENT",PLATFORM_SDK_ALIVE:"PLATFORM_SDK_ALIVE",PLATFORM_SDK_READY:"PLATFORM_SDK_READY",CONTROLLER_COMPONENT_TYPES:["platform.components.AppController","platform.components.AppWidget"],TPA_WIDGET_TYPE_TEMPLATE:{qname:{prefix:"$w",shortName:"IFrame"},componentType:"wysiwyg.viewer.components.tpapps.TPAWidget",tagName:"",members:null,events:null,baseTypes:{},inheritanceChain:null},EVENTS:{controllerSettingsButtonClicked:"controllerSettingsButtonClicked",componentConnectButtonClicked:"componentConnectButtonClicked",createCollectionButtonClicked:"openCreateNewCollection",formBuilderAppClicked:"formBuilderAppClicked",enableDataModeClicked:"enableDataModeClicked",openAddPreset:"openAddPreset"},panelTypes:{COMPONENT_PANEL:"componentPanel",FULL_STAGE:"fullStagePanel",MODAL:"modalPanel",TOOL:"toolPanel"},pages:{page_settings:{layout:{type:e.PAGE_SETTINGS_TABS.LAYOUT,fallbackType:"Pages_Layouts_Tab_Title"},permissions:{type:e.PAGE_SETTINGS_TABS.PERMISSIONS,fallbackType:"Pages_Permissions_Tab_Title"},pageInfo:{type:e.PAGE_SETTINGS_TABS.PAGE_INFO},seo:{type:e.PAGE_SETTINGS_TABS.SEO}},page_actions:{rename:{title:"Pages_Actions_Page_Rename",type:"Pages_Actions_Page_Rename",icon:"quickActionsRename"}}},members:{router_actions:{view_site_members:{title:"Pages_Panel_MemberMenu_SiteMembers_Link",type:"view_site_members",icon:"goToURLAction"},open_signup_settings:{title:"Pages_Panel_MemberMenu_SignupSettings_Link",type:"open_signup_settings",icon:"membersAction"}}},controller:{DEFAULT_STATE:"default"},ORIGIN:{INITIATOR:{EDITOR:"EDITOR",APP:"APP"},TYPE:{ADD_PANEL:"ADD_PANEL",APP_MARKET:"APP_MARKET",DEV_MODE_ON:"DEV_MODE_ON",IMPORT_PANEL:"IMPORT_PANEL"}}}}),define("platform/connection/connection",["lodash","coreUtilsLib","platform/common/constants","stateManagement","experiment"],function(s,p,l,r,c){"use strict";var n=r.editorPlugins.platform.selectors.isConnectedToDataBindingController;function o(e,t){return n(s.head(t),e.dsRead)}var t={connect:{isSelected:function(e){return e.panelManager.findPlatformPanelByType("connect")},isApplied:o,tooltip:"gfpp_component_connect",tooltip_active:"gfpp_component_connected_to_controllers",icon:"connect",rightClickMenuLabel:"PLATFORM_RightClick_Menu_Connect",className:function(e,t){return["gfpp_component_connect",o(e,t)?"connected":""].join(" ")},onClick:e,isSupported:function(e,t){return o=(n=e).dsRead.platform.editorApps.DATA_BINDING.appDefId,i=n.store.getState(),a=s.get(r.editorPlugins.appsStore.selectors.getAppStore(i,o),"dataMode",!1),(c.isOpen("se_dataBindingOutOfDevMode")?a:n.developerMode.isEnabled())&&e.components.is.allowConnectToDB(t)&&!e.isMobileEditor();var n,o,i,a}}};function e(e,t){var n=e.dsRead.platform.getInstalledAppsData(),o=1===n.length?s.head(n):"multiple application ids provided - TODO",i=s.head(t),a=l.EVENTS.componentConnectButtonClicked,r={componentRef:i,componentType:e.components.getType(i),componentSdkType:e.wixCode.getCompSdkType(i),origin:"gfpp"};e.dsActions.platform.notifyApplication(o.applicationId,{eventType:a,eventPayload:p.objectUtils.cloneDeep(r)})}return{init:function(e){return e(t),this},notifyConnectButtonClicked:e}}),define("platform/common/utils",["lodash","util"],function(r,s){"use strict";function p(e,t,n){var o=s.url.setUrlParam(e,"applicationId",t);return s.url.setUrlParam(o,"appDefinitionId",n)}return{getPanelName:function(e){return"platformPanels."+e},getFullApplicationUrl:function(o,e,t,n){var i=r.chain(window.location.search.substr(1)).thru(s.url.parseUrlParams).get("editorPlatformAppSources","").split(",").invokeMap("split",":").fromPairs().value();if(r.startsWith(e,"http"))return p(e,n,t);var a=function(e){var t=r.get(o,"appFields.platform.editorScriptUrl");if(t)return t;var n=r.get(o,"editorArtifact");return n?e?s.url.joinURL(s.serviceTopology.scriptsDomainUrl,"services",n,e):s.serviceTopology.scriptsLocationMap[n]:void 0}(i[t]);return a?p(new URL(e,a).href,n,t):void 0}}}),define("platform/services/tokenService",["lodash"],function(t){"use strict";return{generatePanelToken:function(e){return t.uniqueId("platform_"+e+"_")},generateStaticGlobalPanelToken:function(e){return t.uniqueId("platform_"+e)}}}),define("platform/api/editor/utils/utils",["util"],function(i){"use strict";return{getLinkAsString:function(e,t,n,o){return i.link.getLinkValueAsString(e,o.link)}}}),define("platform/api/document/document",[],function(){"use strict";return{save:function(n){return new Promise(function(e,t){n.saveManager.saveInBackground(function(){e()},t)})}}}),define("platform/api/editor/editor",["lodash","zepto","pmrpc","constants","platform/common/constants","platform/common/utils","platform/services/tokenService","platform/api/editor/utils/utils","platform/api/document/document","stateManagement","experiment"],function(p,r,n,l,s,c,a,e,t,d,f){"use strict";var o=d.editorPlugins.panels.actions,u=o.openPlatformPanel,i=o.updateOrOpenPanel,m={IMAGE:function(e){return{uri:e.uri,title:e.title,width:e.width,height:e.height}},DOCUMENT:function(e){return{uri:e.uri,title:e.title}},DEFAULT:function(e){return e}};function g(e,t){t=t||{};var n=e.panelManager.getOpenPanels(),o=p.find(n,{type:"platform"});if(o){var i=r('[name="'+o.token+'"]');if(i){var a=i.offset();if(a&&p.isNumber(a.top)&&p.isNumber(a.left)){if(p.isNumber(t.x)&&p.isNumber(t.y))return{top:a.top+t.y,left:a.left+t.x};if(p.isNumber(t.height)&&p.get(o,"props.height")&&p.get(o,"props.width"))return{top:a.top+o.props.height/2-t.height/2,left:a.left+o.props.width/2}}}}return{top:"25%",left:"45%"}}function P(e,t,n){var o=e.dsRead.platform.getAppDataByApplicationId(t.applicationId),i=p.assign({token:a.generatePanelToken(o.appDefinitionId)},n);return n.url&&p.assign(i,{url:c.getFullApplicationUrl(o,n.url,o.appDefinitionId,o.applicationId)}),f.isOpen("se_multilingual")&&f.isOpen("se_multilingualHideOnboardingPanel")&&p.assign(i,{appDefinitionId:o.appDefinitionId,instanceId:o.instanceId}),i}return{openPanel:function(e,t,n,o,i){e.panelManager.openPanel(n,o,i)},_OpenSiteMembersSettingsPanel:function(e,t,n){e.store.dispatch(i("panels.focusPanels.siteMembersSettingsPanel",n,!0))},openComponentPanel:function(t,e,n,o){var i=P(t,e,o);return t.selection.selectComponentByCompRef(o.componentRef),new Promise(function(e){t.store.dispatch(u({panelName:c.getPanelName(s.panelTypes.COMPONENT_PANEL),panelProps:i,panelMetaData:{resolve:e,frameType:l.PANEL_TYPES.COMP,closeAllOtherPanels:!0}}))})},openModalPanel:function(t,e,n,o){var i=P(t,e,o);return new Promise(function(e){t.store.dispatch(u({panelName:c.getPanelName(s.panelTypes.MODAL),panelProps:i,panelMetaData:{resolve:e}}))})},openToolPanel:function(t,e,n,o){var i=P(t,e,o),a=c.getPanelName(s.panelTypes.TOOL),r=g(t,o);return p.merge(i,r),new Promise(function(e){t.store.dispatch(u({panelName:a,panelProps:i,panelMetaData:{resolve:e}}))})},openPagePanel:function(e,t,n,o){var i=o.pageRef.id,a=p.get(o,"renameEnabled")||!1,r=e.pages.dynamicPages.getDynamicPageActions(i,"pageSettings"),s=p.isEmpty(r)?{initialSettingsTabType:l.PAGE_SETTINGS_TABS.PAGE_INFO,renameEnabled:a}:{initialSettingsTabType:p.head(r).type,renameEnabled:a};e.navigateAndOpenPagesPanel(i,s)},openPagesPanel:function(i,e,t,a){return new Promise(function(e,t){var n=a.pageRef.id;if(i.pages.doesPageExist(n)){var o={renameEnabled:p.get(a,"renameEnabled"),initialSettingsTabType:p.get(a,"initialSettingsTabType")};i.navigateAndOpenPagesPanel(n,o,e)}else t("PageRef does not exist")})},openFullStagePanel:function(e,t,n,o){var i=P(e,t,o);e.store.dispatch(u({panelName:c.getPanelName(s.panelTypes.FULL_STAGE),panelProps:i,panelMetaData:{frameType:l.PANEL_TYPES.FULL_STAGE,closeAllOtherPanels:!0}}))},openLinkPanel:function(n,e,t,o){return new Promise(function(e){var t={link:p.get(o,"value",null),visibleSections:p.get(o,"visibleSections",null),callback:e,onCancelCallback:e};n.openLinkPanel(t)})},openColorPicker:function(i,e,t,n,a){var o=Object.assign({},{position:{x:-12,y:72},color:"#FFFFFF"},n),r=void 0,s=new Promise(function(e){r=e});return i.panelManager.openPanel("panels.toolPanels.colorPicker.colorPickerPanel",p.merge({value:o.color,onChange:function(e){var t=null,n=null,o=i.theme.colors.getAll();n=e.includes("color_")?(t=o[e],e):(t=e,Object.keys(o).find(function(e){return o[e]===t})),a({color:t,theme:n,isHover:!1})},onClose:r,enableHistory:!1,palettePresets:i.theme.colors.getColorPresets(),updateSitePalette:function(e){return i.theme.colors.update(e)},previewOnHover:!1},g(i,o.position)),!0),s},openMediaPanel:function(i,e,t,a){return a=p.defaults(a||{},{callOnCancel:!0,isMultiSelect:!0,mediaType:"IMAGE"}),new Promise(function(o){i.mediaServices.mediaManager.open(a.mediaType,{multiSelect:a.isMultiSelect,callback:function(e){var t=void 0;if(p.isEmpty(e))a.callOnCancel&&(t=null);else{p.isArray(e)||(e=[e]);var n=p.get(m,a.mediaType,m.DEFAULT);t=e.map(n)}o(t),i.mediaServices.setFocusToEditor()}})})},openHelpPanel:function(e,t,n,o){var i={component:e.selection.getSelectedComponentType(),learn_more:!1,panel_name:"platform"};e.panelManager.openHelpCenter(o.helpId,{origin:"platform"},i)},updatePanelOptions:function(e,t,n,o){var i,a,r=(i=e,a=n,p.find(i.panelManager.getOpenPanels(),{token:a}));if(r){var s=P(e,t,o);s.token=n,e.panelManager.updatePanelProps(r.name,s)}},closePanel:function(e,t,n,o){e.store.dispatch(d.editorPlugins.panels.actions.closePlatformPanel(n,o))},setAppAPI:function(e,t){return n.api.request(t.applicationId,{target:e.dsRead.platform.getAppsContainer()}).then(function(e){n.api.set(t.applicationId,e)})},save:t.save,utils:e,showNotification:function(n,e,t,o){var i=o.title,a=o.message,r=o.type,s=o.link;return"old"===f.getValue("se_notificationCenter")?new Promise(function(e){var t={name:"platform.platformNotification",onClose:e,title:i,message:a,type:r,id:p.uniqueId("notification-")};s&&s.caption&&(t.linkAction={caption:s.caption,onClick:function(){return e(!0)}}),n.store.dispatch(d.editorPlugins.notifications.actions.addNotification(t))}):p.findKey(n.store.getState().notifications,["message",a])?void 0:new Promise(function(e){var t={name:"notifications.editorNotification",onClose:function(){return e()},title:i,message:a,type:r,id:p.uniqueId("notification-"),shouldTranslate:!1};s&&s.caption&&(t.linkAction={caption:s.caption,onClick:function(){return e(!0)},param:s.param}),n.store.dispatch(d.editorPlugins.notifications.actions.showTPAUserActionNotification(t))})},showUserActionNotification:function(n,e,t,o){var i=o.title,a=o.message,r=o.type,s=o.link;return"old"===f.getValue("se_notificationCenter")?new Promise(function(e){var t={name:"platform.platformNotification",onClose:e,title:i,message:a,type:r,id:p.uniqueId("notification-")};s&&s.caption&&(t.linkAction={caption:s.caption,onClick:function(){return e(!0)}}),n.store.dispatch(d.editorPlugins.notifications.actions.addNotification(t))}):p.findKey(n.store.getState().notifications,["message",a])?void 0:new Promise(function(e){var t={name:"notifications.editorNotification",onClose:function(){return e()},title:i,message:a,type:r,id:p.uniqueId("notification-"),shouldTranslate:!1};s&&s.caption&&(t.linkAction={caption:s.caption,onClick:function(){return e(!0)},param:s.param}),n.store.dispatch(d.editorPlugins.notifications.actions.showTPAUserActionNotification(t))})},openBillingPage:function(n,e,t){var o=3<arguments.length&&void 0!==arguments[3]?arguments[3]:{},i=o.premiumIntent,a=o.referrer,r=n.dsRead.platform.getAppDataByApplicationId(e.applicationId).appDefinitionId;return new Promise(function(t){requirejs(["tpa"],function(e){e.packagePicker.startUpgradeFlow(n,r,!0,{premiumIntent:i,origin:a,shouldNavigate:!1}),t()})})},updateAppState:function(e,t,n){var o=e.dsRead.platform.getAppDataByApplicationId(t.applicationId).appDefinitionId;return e.store.dispatch(d.editorPlugins.appsStore.actions.updateAppsStore(o,n))}}}),define("platform/api/editor/preview/preview",[],function(){"use strict";return{navigateTo:function(t,e,n,o){return new Promise(function(e){t.dsActions.platform.pages.navigateTo(o.pageUrl,function(){t.preview.isInPreviewMode()?e():t.preview.togglePreview(e)})})}}}),define("platform/api/document/vfs/vfs",["lodash"],function(r){"use strict";function s(e){return{name:e.name,fullPath:e.location,isDirectory:e.directory}}return{listChildren:function(e,t,n,o){var i=e.wixCode.fileSystem,a=i.getVirtualDescriptor(o.path,!0);return i.getChildren(a).then(function(e){return r.map(e,s)})},readFile:function(e,t,n,o){var i=e.wixCode.fileSystem,a=i.getVirtualDescriptor(o.path,!1);return i.readFile(a)},writeFile:function(e,t,n,o){var i=e.wixCode.fileSystem,a=i.getVirtualDescriptor(o.path,!1);return i.writeFile(a,o.content)},deleteFile:function(e,t,n,o){var i=e.wixCode.fileSystem,a=i.getVirtualDescriptor(o.path,!1);return i.deleteItem(a)},flush:function(e){return e.wixCode.fileSystem.flush()}}}),define("platform/api/document/pages/pages",["lodash","util"],function(s,r){"use strict";return{navigateTo:function(t,e,n,o){var i=s.get(o,"pageRef.id"),a=s.get(o,"pageLink"),r=i||a;if(r)return new Promise(function(e){t.pages.navigateTo(r,function(){e()})})},rename:function(e,t,n,o){var i=o.pageRef.id,a=r.validate.pageNameValidator(o.title);return a||e.pages.data.update(i,{title:o.title}),a},add:function(n,e,t,o){return new Promise(function(e){var t=n.pages.add(o.title,o.definition,o.shouldAddMenuItem);n.pages.navigateTo(t.id,function(){e(t)})})},remove:function(a,r,e,s){return new Promise(function(e,t){var n=r.appDefinitionId,o=s.pageRef,i=a.dsRead.pages.data.get(o.id);return i?n!==i.managingAppDefId?t("page with id '"+o.id+"' can not be deleted. page is not managed by this application"):a.dsRead.viewMode.get()===a.dsRead.viewMode.VIEW_MODES.MOBILE?t("page with id '"+o.id+"' can not be deleted. deletion is not allowed in mobile view"):void a.pages.remove(o.id,e,function(){return t("removed canceled")}):t("page with id '"+o.id+"' doesn't exist")})},data:{update:function(e,t,n,o){var i=o.pageRef.id;e.pages.data.update(i,o.data)}}}}),define("platform/api/document/components/components",["lodash"],function(d){"use strict";return{add:function(l,e,t,c){return new Promise(function(e,t){d.isEmpty(c.componentDefinition.componentType)&&t(new Error("componentDefinition must contain componentType"));var n,o,i,a,r,s=l.components.buildDefaultComponentStructure(c.componentDefinition.componentType);n=l,o=s,i=c,a=d.get(i,"pageRef.id")||n.dsRead.pages.getFocusedPageId(),r=n.pasteLogic.addContext.getPastePosition(n,o.layout,a),d.merge(o.layout,r),d.merge(s,c.componentDefinition);var p=l.components.add(c.pageRef,s,c.customId,void 0,"editorSdk",{showAddToHeaderPanel:c.showAddToHeaderPanel});l.dsActions.waitForChangesApplied(function(){l.components.is.exist(p)?e(p):t(new Error("Could not add component"))})})},getPage:function(e,t,n,o){return e.components.getPage(o.componentRef)},properties:{get:function(e,t,n,o){return e.components.properties.get(o.componentRef)},update:function(e,t,n,o){e.components.properties.update(o.componentRef,o.props)}},data:{get:function(e,t,n,o){return e.components.data.get(o.componentRef)},update:function(e,t,n,o){e.components.data.update(o.componentRef,o.data,!0)}},layout:{get:function(e,t,n,o){return e.components.layout.get(o.componentRef)}}}}),define("platform/api/document/routers/routers",["lodash","util"],function(s,p){"use strict";return{isValidPrefix:function(e,t,n,o){var i=s.get(t,"applicationId"),a=e.dsRead.routers.isValidPrefix(i,o.prefix);if(!a.valid){var r="";switch(a.message){case 1:r="DYNAMIC_PAGES_VALIDATION_PREFIX_CAN_NOT_BE_EMPTY";break;case 2:r="DYNAMIC_PAGES_VALIDATION_PREFIX_IS_TOO_LONG";break;case 3:r="DYNAMIC_PAGES_VALIDATION_PREFIX_IS_DUPLICATE_OF_URISEO";break;case 4:r="DYNAMIC_PAGES_VALIDATION_PREFIX_CONTAINS_INVALID_CHARCTERS";break;case 5:r="DYNAMIC_PAGES_VALIDATION_PREFIX_IS_FORBIDDEN_WORD";break;case 6:r="DYNAMIC_PAGES_VALIDATION_PREFIX_IS_IN_USE_BY_ANOTHER_APPLICATION"}a.message=p.translate(r)}return a},pages:{delete:function(i,a,e,r){return new Promise(function(e,t){var n=s.get(i.dsRead.platform.getAppDataByApplicationId(a.applicationId),"appDefinitionId"),o=i.dsRead.routers.get.byRef(r.routerRef);o&&o.appDefinitionId===n?i.pages.remove(r.pageRef.id,function(){e()},function(){t()},!1):t()})}}}}),define("platform/api/document/history/history",[],function(){"use strict";return{add:function(t,e,n,o){return new Promise(function(e){t.dsActions.waitForChangesApplied(function(){t.history.add(o.label,null,o.historySnapshotId),e()})})}}}),define("platform/api/editor/ide/ide",["lodash"],function(l){"use strict";function c(e,t,n,o){return e.wixCode.collectionsTree.navigateToCollection(e,o.name)}return{openFile:function(e,t,n,o){var i,a,r,s=o.path,p=e.wixCode.fileSystem.getRoots().schemas.location;return a=p,r=s,l.startsWith(r,a)&&l.endsWith(r,".json")?c(e,0,0,{name:(i=p,o.path.replace(i,"").replace(".json",""))}):e.wixCode.fileTree.navigateToFile(e,o.path,l.pick(o,["functionName","caretOffset","caretLocation"]))},navigateToCollection:c,treePane:{isOpen:function(e){return e.developerMode.ui.treePane.isOpen()},toggle:function(t){return new Promise(function(e){t.developerMode.ui.treePane.toggle(function(){e()})})}}}}),define("platform/api/editor/info/info",["lodash","stateManagement","util"],function(c,e,o){"use strict";var n=e.editorPlugins.leftBar.selectors.getDeviceType;var t=window.mainLoaded||0;function d(){var e=window.location.hostname.match(/editor\.(.*)/);return e?"www."+e[1]:"www.wix.com"}function f(e){return!e.dsRead.generalInfo.isFirstSave()}return{getDashboardUrl:function(s,p,e,l){return new Promise(function(o,i){var e=c.get(l,"appDefinitionId"),a=e||c.get(s.dsRead.platform.getAppDataByApplicationId(p.applicationId),"appDefinitionId"),r=e?c.get(s.dsRead.platform.getAppDataByAppDefId(a),"applicationId"):p.applicationId,t=f(s),n=function(){var e,t,n;a===s.dsRead.platform.editorApps.DATA_BINDING.appDefId?o((n=s,["//",d(),"/my-account/sites/",n.dsRead.generalInfo.getMetaSiteId(),"/simple-app","?app=wixcode","&referralInfo=editor_platform"].join(""))):s.dsRead.tpa.app.isHybrid(r)||s.dsRead.tpa.app.isDashboardAppOnly(r)?o((e=s,t=a,["//",d(),"/my-account/sites/",e.dsRead.generalInfo.getMetaSiteId(),"/app/",t,"?referralInfo=editor"].join(""))):i("The given appDefinitionId does not have an dashboard URL.")};t?n():s.saveManager.saveInBackground(function(){n()},i)})},getBusinessManagerUrl:function(e){if(!f(e))throw new Error("Site has never been saved");var t=o.serviceTopology.businessManagerUrl,n=e.dsRead.generalInfo.getMetaSiteId();return o.url.joinURL(t,n)},getMetaSiteId:function(e){return e.dsRead.generalInfo.getMetaSiteId()},getSiteMediaToken:function(e,t){return t?e.dsRead.generalInfo.media.getSiteUploadToken():e.dsRead.generalInfo.getSiteToken()},getEditorSessionId:function(){return o.editorSessionUtil.editorSessionId},getSiteId:function(e){return e.dsRead.generalInfo.getSiteId()},getEditorReadyTimestamp:function(){return c.now()-t},getEditorMode:function(e){var t=e.store.getState();return n(t)},getAppDefinitionId:function(e,t){var n=t.applicationId;return e.dsRead.platform.getAppDataByApplicationId(n).appDefinitionId},isSitePublished:function(e){return e.dsRead.generalInfo.isSitePublished()},getLanguage:function(e){return e.dsRead.generalInfo.getLanguage()},isSiteSaved:f}}),define("platform/api/editor/environment/environment",["util"],function(e){"use strict";return{getLocale:function(){return e.editorModel.languageCode}}}),define("platform/api/editor/userPreferences/userPreferences",["lodash","coreUtilsLib","stateManagement"],function(s,p,l){"use strict";return{site:{set:function(o,i,e,a){return new Promise(function(e,t){var n=s.get(o.dsRead.platform.getAppDataByApplicationId(i.applicationId),"appDefinitionId");n||t(new Error("Illegal appData - application is not registered in clientSpecMap")),o.registerInitUserPrefsCallback(function(){s.forEach(a,function(e,t){o.store.dispatch(l.editorPlugins.userPreferences.actions.setSiteUserPreferences(t,e,n))}),e()})})},get:function(i,a,e,r){return new Promise(function(t,e){var n=s.get(i.dsRead.platform.getAppDataByApplicationId(a.applicationId),"appDefinitionId");n||e(new Error("Illegal appData - application is not registered in clientSpecMap"));var o=s.isArray(r)?s(r).keyBy().mapValues(s.noop).value():r;i.registerInitUserPrefsCallback(function(){var e=s.mapValues(o,function(e,t){return p.objectUtils.cloneDeep(l.editorPlugins.userPreferences.selectors.getSiteUserPreferences(t,n)(i.store.getState()))});t(s.defaults(e,o))})})}}}}),define("platform/api/document/tpa/tpa",["lodash"],function(s){"use strict";return{add:{application:function(e,t,n,o){return new Promise(function(t,n){s.get(o,"appDefinitionId")?e.tpa.addApplication(o.appDefinitionId,o).then(function(e){t(e)}).catch(function(e){n(e)}):n(new Error("options must contain appDefinitionId"))})},component:function(e,o,t,i){return new Promise(function(t,n){if((i=i||{}).componentType){if(i.appDefinitionId||(i.appDefinitionId=o.appDefinitionId),"WIDGET"===i.componentType){if(!s.isObject(i.widget))return void n(new Error("options must contain a widget object"));i.widget.tpaWidgetId=i.widget.widgetId}else if("PAGE"===i.componentType){if(!s.isObject(i.page))return void n(new Error("options must contain a page object"));if(i.page.isHidden&&!s.isBoolean(i.page.isHidden))return void n(new Error("isHidden param should be of type boolean"))}e.tpa.addComponent(i).then(function(e){t(e)}).catch(function(e){n(e)})}else n(new Error("options must contain componentType"))})}},isApplicationInstalled:function(n,e,t,o){return new Promise(function(e,t){s.get(o,"appDefinitionId")?e(n.dsRead.tpa.app.isInstalled(o.appDefinitionId)):t(new Error("options must contain appDefinitionId"))})},isAppSectionInstalled:function(i,a,e,r){return new Promise(function(e,t){if(s.get(r,"sectionId")){var n=a.applicationId;if(r.appDefinitionId){var o=i.dsRead.tpa.app.getDataByAppDefId(r.appDefinitionId);n=s.get(o,"applicationId")}e(i.dsRead.tpa.section.isSectionInstalledByTpaPageId(n,r.sectionId))}else t(new Error("options must contain sectionId"))})}}}),define("platform/api/document/application/application",["lodash","util","platform/common/constants"],function(l,c,d){"use strict";return{install:function(r,s,e,p){return c.fedopsLogger.interactionStarted(c.fedopsLogger.INTERACTIONS.INSTALL_APP),new Promise(function(t,n){var o=l.get(p,"appDefinitionId");if(o)if(o!==r.platform.editorApps.WIX_CODE.appDefId){var e=r.tpa.bi.consts.APP.TYPE.PLATFORM_ONLY,i=r.tpa.bi.consts.BI.initiator.PLATFORM,a={initiator:d.ORIGIN.INITIATOR.APP,info:{appDefinitionId:l.get(s,"appDefinitionId")}};r.tpa.services.tpaAddAppService.addApp(r,p.appDefinitionId,null,null,e,i,!1,{},{},function(e){l.get(e,"success")?(c.fedopsLogger.interactionStarted(c.fedopsLogger.INTERACTIONS.INSTALL_APP),t(e)):(c.ravenUtils.captureError(e,{tags:{appInstallFailed:o},extra:{appData:s,options:p}}),n(e))},a)}else r.wixCode.provision({onSuccess:t,onError:n});else n(new Error("options must contain appDefinitionId"))})}}}),define("platform/api/internalAPIs",["lodash"],function(o){"use strict";return{addApp:function(e,t,n){e.wixCode.provision(o.noop,o.noop),e.dsActions.platform.initApp({appDefinitionId:o.get(n,"appDefinitionId"),editorUrl:o.get(n,"editorUrl"),viewerUrl:o.get(n,"viewerUrl")})}}}),define("platform/api/editor/selection/selection",["lodash"],function(i){"use strict";return{getSelectedComponents:function(e){return e.selection.getSelectedComponents()},deselectComponents:function(e,t,n,o){e.selection.deselectComponents(i.get(o,"compsToDeselect",[]))},selectComponentByCompRef:function(e,t,n,o){e.selection.selectComponentByCompRef(i.get(o,"compsToSelect",[]))}}}),define("platform/api/editor/developerMode/developerMode",[],function(){"use strict";return{isEnabled:function(e){return e.developerMode.isEnabled()}}}),define("platform/api/api",["lodash","platform/api/editor/editor","platform/api/document/document","platform/api/editor/preview/preview","platform/api/document/vfs/vfs","platform/api/document/pages/pages","platform/api/document/components/components","platform/api/document/routers/routers","platform/api/document/history/history","platform/api/editor/ide/ide","platform/api/editor/info/info","platform/api/editor/environment/environment","platform/api/editor/userPreferences/userPreferences","platform/api/document/tpa/tpa","platform/api/document/application/application","platform/api/internalAPIs","platform/api/editor/selection/selection","platform/api/editor/developerMode/developerMode"],function(e,t,n,o,i,a,r,s,p,l,c,d,f,u,m,g,P,A){"use strict";var I={document:e.assign(n,{application:m,components:r,history:p,pages:a,routers:s,tpa:u,vfs:i}),editor:e.assign(t,{environment:d,ide:l,info:c,__internal__:g,preview:o,selection:P,userPreferences:f,developerMode:A})};return e.merge(I,I.document,I.editor)}),define("platform/services/platformPostMessageService",["lodash","pmrpc","coreUtilsLib","platformEvents","platform/common/constants"],function(r,o,s,p,l){"use strict";return{init:function(e,t){o.api.set(l.EDITOR_API_NS,t)},createPostMessageListener:function(i,a){return function(e){if(e.data.intent===l.PLATFORM_PANEL&&e.data.sourcePanel===a)switch(e.data.type){case l.PLATFORM_SDK_READY:t=e.source,n={intent:l.PLATFORM_ON_EVENT,event:p.factory.startConfiguration(i)},r.isUndefined(t)||(n.event.eventPayload=s.objectUtils.cloneDeep(n.event.eventPayload),t.postMessage||(t=t.contentWindow),t.postMessage(n,o||"*"));break;default:return}var t,n,o}},onSetAppPublicAPI:function(e,t){var n=t.apiName;return o.api.request(n,{target:e.dsRead.platform.getAppsContainer()}).then(function(e){o.api.set(n,e)})}}}),define("platform/services/platformWorkerService",["host-worker-init"],function(e){"use strict";var o=e.workerMessagesService;return{createWorkerMessagesAPI:function(){return fetch("https://76897fda-d78f-49dd-bd02-bf9ad52a4f11.dev.wix-code.com/_partials/santa/1.4316.0/node_modules/santa-wix-code/dist/wixcode-worker.js").then(function(e){return new Response(e.body)}).then(function(e){return e.blob()}).then(function(e){return URL.createObjectURL(e)}).then(function(e){var t={sdkSource:"https://static.parastorage.com/services/js-wixcode-sdk/1.242.0/lib/wix.js",namespacesSdkSource:"https://static.parastorage.com/services/wixcode-namespaces/1.3.0/wixcode-namespaces.js",externalComponentsSource:"https://rawgit.com/yotamsha/statics/31a1ae3a8f2688ada5a63ea387dfec9a61d4268c/wixcode-components.min.js",workerProps:{workerUrl:e}},n=o.getAPI();return n.init(t),n})}}}),define("platform/plugins/componentsRemoveHandlerPlugins",["lodash","stateManagement"],function(s,p){"use strict";return{confirmOnOrphanConnections:function(e,t,n,o,i){if(function(t,e,n){var o=(n=s(n)).filter(function(e){return"platform.components.AppController"===t.components.getType(e)});if(o.isEmpty())return!1;var i=n.map("id").value();return o.map(function(e){return t.platform.controllers.connections.getConnectedComponents(e)}).some(function(e){return!s(e).map("id").difference(i).isEmpty()})}(t,0,o)){var a=s.filter(o,function(e){return"platform.components.AppController"===t.components.getType(e)}),r=1===a.length;return e(p.editorPlugins.panels.actions.updateOrOpenPanel("platform.panels.appControllerDeleteConfirmationPanel",{onConfirm:i,isSingleController:r,controllerDisplayName:r?t.platform.controllers.getName(a[0]):""})),!0}return!1}}}),define("platform/panels/appControllerDeleteConfirmationPanel.rt",["react","lodash","panels","baseUI"],function(e,t,n,o){"use strict";return function(){return e.createElement(n.frames.confirmationPanelFrame,{type:"important",panelName:"platform.panels.appControllerDeleteConfirmationPanel",onConfirm:this.props.onConfirm,confirmLabel:"PLATFORM_messages_delete",cancelLabel:"PLATFORM_messages_cancel_delete",panelTitle:this.getTitle()},e.createElement("div",{className:"icon"},e.createElement(o.symbol,{name:"deleteBlogConfirmationIcon"})),e.createElement("div",{className:"content"},e.createElement("p",{},this.getContentText())))}}),define("platform/panels/appControllerDeleteConfirmationPanel",["create-react-class","prop-types","core","util","platform/panels/appControllerDeleteConfirmationPanel.rt"],function(e,t,n,o,i){"use strict";return e({displayName:"appControllerDeleteConfirmationPanel",propTypes:{controllerDisplayName:t.string,isSingleController:t.bool,onConfirm:t.func},mixins:[o.translationMixin,n.mixins.editorAPIMixin],getContentText:function(){var e=this.props.isSingleController?"PLATFORM_messages_delete_dataset_text":"PLATFORM_messages_multidelete_dataset_text";return this.translateTemplate(e,{appName:"Wix Database"},this.getEditorAPI())},getTitle:function(){var e=this.props.isSingleController?"PLATFORM_messages_delete_dataset_title":"PLATFORM_messages_multidelete_dataset_title";return this.translateTemplate(e,{appControllerName:this.props.controllerDisplayName},this.getEditorAPI())},render:i})}),define("platform/panels/warnForDisconnectedComponentsPanel.rt",["react","lodash","panels","baseUI"],function(e,t,n,o){"use strict";return function(){return e.createElement(n.frames.confirmationPanelFrame,{type:"important",panelName:"platform.panels.warnForDisconnectedComponentsPanel",onCancel:this.props.undo,confirmLabel:"PLATFORM_messages_continue",cancelLabel:"PLATFORM_messages_cancel",shouldCloseByDefaultOnConfirm:!0,panelTitle:this.getTitle()},e.createElement("div",{className:"icon"},e.createElement(o.symbol,{name:"platformWarning"})),this.props.connectedComps?e.createElement("div",{className:"content",key:"connectedCompsContent"},e.createElement("p",{},this.translateIfNeeded("PLATFORM_messages_move_connected_element_text_line1")),e.createElement("p",{},this.translateIfNeeded("PLATFORM_messages_move_connected_element_text_line2"))):null,this.props.connectedComps?null:e.createElement("div",{className:"content",key:"connectedDatasetContent"},e.createElement("p",{},this.translateIfNeeded("PLATFORM_messages_move_connected_dataset_text_line1")),e.createElement("p",{},this.translateIfNeeded("PLATFORM_messages_move_connected_dataset_text_line2"))))}}),define("platform/panels/warnForDisconnectedComponentsPanel",["create-react-class","prop-types","lodash","util","platform/panels/warnForDisconnectedComponentsPanel.rt"],function(e,t,n,o,i){"use strict";return e({displayName:"warnForDisconnectedComponentsPanel",propTypes:{undo:t.func.isRequired,connectedComps:t.bool.isRequired},mixins:[o.translationMixin],getTitle:function(){var e=this.props.connectedComps?"PLATFORM_messages_move_connected_element_title":"PLATFORM_messages_move_connected_dataset_title";return this.translateIfNeeded(e)},render:i})}),define("platform/platformNotification/platformNotification.rt",["react","lodash","notifications","baseUILib"],function(e,t,n,o){"use strict";return function(){return e.createElement(n.notificationFrame,{type:this.props.type,close:this.close},e.createElement("div",{className:"platform-notification-content"},this.props.title?e.createElement(o.RichText,{key:"notification-title",type:"T07",className:"notification-title"},this.props.title):null,e.createElement(o.RichText,{},e.createElement("p",{className:"notification-message"},this.props.message)),e.createElement(o.RichText,{},this.props.linkAction&&this.props.linkAction.caption?e.createElement("a",{className:"notification-link",onClick:this.onLinkClicked,key:"notification-link-action"},this.props.linkAction.caption):null)))}}),define("platform/platformNotification/platformNotification",["lodash","create-react-class","prop-types","constants","platform/platformNotification/platformNotification.rt"],function(e,t,n,o,i){"use strict";return t({displayName:"platformNotification",propTypes:{name:n.string,type:n.oneOf(e.values(o.NOTIFICATIONS.TYPES)).isRequired,title:n.string,message:n.string.isRequired,linkAction:n.shape({caption:n.string.isRequired,onClick:n.func.isRequired}),close:n.func.isRequired,onClose:n.func.isRequired},close:function(){this.props.onClose(),this.props.close()},onLinkClicked:function(){this.props.linkAction.onClick(),this.props.close()},render:i})}),define("platform/plugins/notifyApplicationAfterComponentPasted",["lodash","platformEvents"],function(t,a){"use strict";return function(i,e){t.forEach(e,function(e){var t=i.platform.controllers.connections.getPrimaryConnection(e);if(t){var n=i.components.data.get(t.controllerRef).applicationId,o=i.platform.getAppDataByAppDefId(n).applicationId;i.platform.notifyApplication(o,a.factory.connectedComponentPasted({componentRef:e,connection:t}))}})}}),define("platform/plugins/platformCompNamePlugin",[],function(){"use strict";return{create:function(a){var r=(1<arguments.length&&void 0!==arguments[1]?arguments[1]:{}).considerControllerTypeDisplayName;return function(e){var t=a.dsRead.platform.controllers.getStageData(e);if(t){if(t.displayName)return t.displayName;if(r&&t.controllerTypeDisplayName)return t.controllerTypeDisplayName}var n=a.dsRead.components.data.get(e).applicationId;if(n===a.dsRead.platform.editorApps.DATA_BINDING.appDefId)return"";var o=a.dsRead.platform.getAppDataByAppDefId(n);if(o){var i=a.dsRead.tpa.appMarket.getData(n);return i&&i.name?i.name:o.appDefinitionName||""}return""}}}}),define("platform/addPanel/sectionTypesMap",["addPanelDataConsts"],function(e){"use strict";return{LIST:e.SECTIONS_TYPES.GENERIC_LIST_SECTION}}),define("platform/addPanel/imagesMap",[],function(){"use strict";return{ROBOT:"platform/widgetSection/add-panel-robot.png"}}),define("platform/addPanel/categoryDefinitionValidator",["lodash","platform/addPanel/sectionTypesMap"],function(a,r){"use strict";var s=function(e){return a.isString(e)&&!a.isEmpty(e)};return{validate:function(){var e,t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},n=t.title,o=t.header,i=t.type;return s(n)&&s(o)&&(e=i,a.has(r,e))}}}),define("platform/addPanel/sectionDefinitionValidator",["lodash","platform/addPanel/imagesMap"],function(a,r){"use strict";var s=["IMAGE_LIST"];return{validate:function(){var e,t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},n=t.title,o=t.image,i=t.imageSource;return e=n,a.isString(e)&&!a.isEmpty(e)&&a.includes(s,i)&&a.has(r,o)}}}),define("platform/addPanel/sectionsGenerator",["lodash","stateManagement","coreUtilsLib","platform/addPanel/sectionTypesMap","platform/addPanel/imagesMap","platform/addPanel/categoryDefinitionValidator","platform/addPanel/sectionDefinitionValidator"],function(l,e,n,c,s,o,d){"use strict";var a=e.platform.selectors,p=e.platform.actions,f=function(e,t,n){var o=n.title,i=n.desc,a=n.image,r=n.id;return{id:r,title:o,desc:i,shouldTranslate:!1,showSectionHeader:!0,symbol:"plusBig",tooltip:"add_section_add_page_blankpage_tooltip",image:s[a],onItemClick:function(){e.panelManager.closeAllPanels(),e.store.dispatch(p.notifyAddWidget(t,r))}}},r=function(e,t,n){var o,i,a,r,s=n.app,p=n.categoryDefinition;return{hide:!1,id:s.appDefinitionId,type:c[p.type],title:p.title,subNavigationTitle:p.title,presetTitle:p.header,subNavigationHide:t,showSectionHeader:!0,shouldTranslate:!1,help:{text:p.helpText},props:{items:(o=e,i=s.applicationId,a=p,r=a.items,l(r).partition(d.validate).thru(function(e){var t=_slicedToArray(e,2),n=t[0],o=t[1];return u(o,"section"),n}).map(l.partial(f,o,i)).value())}}},u=function(e,t){return l.forEach(e,function(e){return n.log.error("Invalid "+t+" definition: "+JSON.stringify(e))})};return{createSections:function(t){var e=t.dsRead.platform.getInstalledEditorApps(),i=void 0;return l(e).map(function(e){return{app:e,categoryDefinition:a.getAddPanelCategoryDefinitionFromManifest(t.dsRead,e.appDefinitionId)}}).filter("categoryDefinition").partition(function(e){var t=e.categoryDefinition;return o.validate(t)}).thru(function(e){var t=_slicedToArray(e,2),n=t[0],o=t[1];return u(o,"category"),i=!(5<=n.length),n}).map(function(e){return r(t,i,e)}).sortBy("title").value()}}}),define("platform/addPanel/platformAddPanel",["addPanelDataConsts","platform/addPanel/sectionsGenerator"],function(t,n){"use strict";return{register:function(){require(["addPanelInfra"],function(e){e.addPanelData.manager.override.sections.register(t.CATEGORIES_ID.INSTALLED_APPS,n.createSections)})}}}),define("platform",["lodash","platformEvents","experiment","util","coreBi","platform/appController/appController","platform/connection/connection","platform/api/api","platform/services/platformPostMessageService","platform/services/platformWorkerService","platform/services/platformConnectedGfpp","platform/services/tokenService","platform/common/constants","platform/common/utils","platform/plugins/componentsRemoveHandlerPlugins","platform/panels/appControllerDeleteConfirmationPanel","platform/panels/warnForDisconnectedComponentsPanel","platform/platformNotification/platformNotification","platform/plugins/notifyApplicationAfterComponentPasted","platform/plugins/platformCompNamePlugin","platform/utils/upgradeUtils","platform/addPanel/platformAddPanel","stateManagement"],function(a,n,r,s,p,l,c,d,f,u,e,t,o,i,m,g,P,A,I,v,_,T,C){"use strict";function h(t){var e=t.platform.getInstalledEditorApps();a.forEach(e,function(e){t.dsActions.platform.notifyApplication(e.applicationId,n.factory.siteWasPublished())})}return{api:d,init:function(e,t,n){var o=function t(e,n){return a.isFunction(e)?a.partial(e,n):a.isObject(e)?a.mapValues(e,function(e){return t(e,n)}):e}(d,e),i=e.dsRead.platform.getAPIForSDK(o);return l.init(e,n),c.init(t),f.init(e,i),e.dsActions.platform.init(o),function(i){i.dsActions.platform.registerToManifestAdded(function(){return i.store.dispatch(C.editorPlugins.services.actions.onViewerChanged())}),i.dsActions.platform.registerToManifestAdded(function(e,t){return function(e){var t="manifest set for app "+e;s.performance.mark(t);var n="time for manifest app "+e;s.performance.measure(n,"editor ready",t);var o=s.performance.getMeasure(n).duration;i.bi.event(p.events.editor.APP_MANIFEST_LOADED,{ts:Math.round(o),app_id:e})}(t.appDefinitionId)}),i.registerSitePublishedCallbacks(a.partial(h,i)),i.registerAfterPasteComponentCallback(I),i.registerComponentsRemoveHandlerPlugin(m.confirmOnOrphanConnections);var e=a.partial(f.onSetAppPublicAPI,i);return i.dsActions.platform.registerToPublicApiSet(e),i.registerCompNamePlugin("platform.components.AppWidget",v.create(i)),i.registerCompNamePlugin("platform.components.AppController",v.create(i,{considerControllerTypeDisplayName:!0})),new Promise(function(t){r.isOpen("se_platform_modal_native_panel")?u.createWorkerMessagesAPI().then(function(e){i.store.dispatch(C.editorPlugins.rendererPanelsWorkerService.actions.setWorkerMessagesAPI(e)),t()}):t()})}(e)},platformPostMessageService:f,platformConnectedGfpp:e,tokenService:t,constants:o,utils:i,upgradeUtils:_,panels:{appControllerDeleteConfirmationPanel:g,warnForDisconnectedComponentsPanel:P},platformNotification:A,onAddPanelLoaded:function(e){T.register(e)}}});
//# sourceMappingURL=platform.min.js.map