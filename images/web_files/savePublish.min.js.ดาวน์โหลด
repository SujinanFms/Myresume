define("savePublish/utils/failedPanelUtil",["lodash"],function(t){"use strict";return{extractDocumentErrorCode:function(e){return t.get(e,"document.errorCode")||t.get(e,"documentServices.errorCode")},extractDocumentErrorType:function(e){return t.get(e,"document.errorType")||t.get(e,"documentServices.errorType")}}}),define("savePublish/constants/savePublishErrorPanelData",[],function(){"use strict";return{SITE_NAME_TAKEN_PANEL_DATA:{titleKey:"ERROR_SITE_NOT_RENAMED_TITLE_LABEL",description:"ERROR_SITE_NOT_RENAMED_BODY_SUBTITLE",steps:["ERROR_SITE_NOT_RENAMED_STEP1_TEXT","ERROR_SITE_NOT_RENAMED_STEP2_TEXT","ERROR_SITE_NOT_RENAMED_STEP3_TEXT"],stepsTitle:"ERROR_SITE_NOT_RENAMED_TRY_STEPS"},SAVE_DISABLED_ON_SERVER_PANEL_DATA:{titleKey:"SAVE_ERROR_TITLE_LABEL",description:"Save_Publish_ServerErrorLabel_OnSave",showSteps:!1,showFooterText:!1},USER_NOT_AUTHORIZED_FOR_SITE:{titleKey:"SAVE_ERROR_17_TITLE",description:"SAVE_ERROR_17_DESCRIPTION_HEADER",steps:["SAVE_ERROR_17_DESCRIPTION_STEP1","SAVE_ERROR_17_DESCRIPTION_STEP2","SAVE_ERROR_17_DESCRIPTION_STEP3"],helpMessage:"SAVE_ERROR_LEARN_MORE_LABEL",helpLinkMessage:"SAVE_ERROR_LEARN_MORE_LINK"},NOT_LOGGED_IN:{titleKey:"SAVE_ERROR_15_TITLE",description:"SAVE_ERROR_15_DESCRIPTION_HEADER",steps:["SAVE_ERROR_15_DESCRIPTION_STEP1","SAVE_ERROR_15_DESCRIPTION_STEP2","SAVE_ERROR_15_DESCRIPTION_STEP3"],helpMessage:"SAVE_ERROR_LEARN_MORE_LABEL",helpLinkMessage:"SAVE_ERROR_LEARN_MORE_LINK"},PUBLISH_DISABLED_ON_SERVER_PANEL_DATA:{titleKey:"PUBLISH_ERROR_TITLE_LABEL",description:"Save_Publish_ServerErrorLabel_OnPublish",showSteps:!1,showFooterText:!1},NAME_SITE_AGAIN_PANEL_DATA:{titleKey:"ERROR_NAME_SITE_AGAIN_TITLE_LABEL",description:"ERROR_NAME_SITE_AGAIN_SUBTITLE",steps:["ERROR_NAME_SITE_AGAIN_STEP1_TEXT","ERROR_NAME_SITE_AGAIN_STEP2_TEXT","ERROR_NAME_SITE_AGAIN_STEP3_TEXT"],stepsTitle:"ERROR_NAME_SITE_AGAIN_TRY_STEPS"},SAVE_ERROR_DEFAULT_PANEL_DATA:{titleKey:"SAVE_ERROR_TITLE_LABEL",description:"SAVE_PUBLISH_ERROR_BODY_DESCRIPTION",steps:["SAVE_PUBLISH_SAVE_ERROR_OPTION_1","SAVE_PUBLISH_SAVE_ERROR_OPTION_2"],stepsTitle:"SAVE_PUBLISH_ERROR_BODY_DESCRIPTION_BOLD",helpMessage:"SAVE_ERROR_LEARN_MORE_LABEL",helpLinkMessage:"SAVE_PUBLISH_ERROR_LEARN_MORE_LINK",helpLink:"8045e8e4-6f47-4913-8d74-6239f21fffec"},PUBLISH_ERROR_DEFAULT_PANEL_DATA:{titleKey:"PUBLISH_ERROR_TITLE_LABEL",description:"SAVE_PUBLISH_ERROR_BODY_DESCRIPTION",steps:["SAVE_PUBLISH_ERROR_OPTION_1","SAVE_PUBLISH_ERROR_OPTION_2"],helpMessage:"PUBLISH_ERROR_LEARN_MORE_LABEL",helpLinkMessage:"SAVE_PUBLISH_ERROR_LEARN_MORE_LINK",helpLink:"3de8a931-e665-4c9f-bcb3-7096ea89f9e3"},VALIDATION_ERROR:{titleKey:"Notification_Box_Data_Curruption_Error_Title",description:"Notification_Box_Data_Curruption_Error_Text",showSteps:!1,helpMessage:null,helpLinkMessage:null,helpLink:null,confirmLabel:"Notification_Box_Data_Curruption_Error_Reload_Button"}}}),define("savePublish/managers/saveManager",["lodash","util","savePublish/utils/failedPanelUtil","baseUI","stateManagement","savePublish/constants/savePublishErrorPanelData","coreBi","constants","experiment"],function(U,B,M,t,y,k,w,V,H){"use strict";var F=y.editorPlugins.domain.selectors,x=y.editorPlugins.savePublish.selectors;return function(r,i){var o=r.store,n=2592e6,l={ON_BOARDING_MIGRATION:"savePublish.panels.save.onBoardingMigrationConfirmationPanel",CHOOSE_DOMAIN:"savePublish.panels.save.chooseDomainPanel",SITE_WAS_SAVED:"savePublish.panels.save.siteWasSavedPanel",SAVE_FAILED:"savePublish.panels.common.failPanel",VALIDATION_ERROR:"panels.messagePanels.validationErrorPanel",CONCURRENT_SAVE:"savePublish.panels.save.concurrentSavePanel",SAVE_REMINDER:"savePublish.panels.save.saveReminderPanel"},a={SITE_SAVED_WELCOME_BACK_TITLE:"SAVE_SITE_SAVED_WELCOME_BACK_TITLE",SITE_SAVED_WELCOME_BACK_SUBTITLE:"SAVE_SITE_SAVED_WELCOME_BACK_SUBTITLE"},c=(B.serviceTopology.editorServerRoot||"//editor.wix.com/html/editor/web")+"/renderer/edit/<%= siteId %>",u=void 0;function p(){for(var e=r.dsRead.siteName.getUsed(),t=x.getOverridingSiteDefaultName(o.getState()),s=B.translate(t||"Save_Publish_Site_Default_Name"),n=r.siteName.sanitize(s.slice(0,20).replace(/\-$/,"").replace(/_/g,"-")),i=1;U.includes(e,n);){var a="-"+i;n=s.slice(0,20-a.length).replace(/\-$/,"").replace(/_/g,"-")+a,i++}return n}function d(e,t){switch(t){case r.dsRead.errors.save.SITE_NAME_TAKEN:S(e,k.SITE_NAME_TAKEN_PANEL_DATA);break;case r.dsRead.errors.save.SAVE_PUBLISH_DISABLED_ON_SERVER:S(e,k.SAVE_DISABLED_ON_SERVER_PANEL_DATA);break;case r.dsRead.errors.save.NOT_LOGGED_IN:S(e,k.NOT_LOGGED_IN);break;case r.dsRead.errors.save.USER_NOT_AUTHORIZED_FOR_SITE:S(e,k.USER_NOT_AUTHORIZED_FOR_SITE);break;case r.dsRead.errors.save.DUPLICATE_COMPONENTS:case r.dsRead.errors.save.DATA_REFERENCE_MISMATCH:case r.dsRead.errors.save.MISSING_CONTAINERS:case r.dsRead.errors.save.APP_CONTROLLER_REFERENCE_MISMATCH:case r.dsRead.errors.save.BEHAVIOR_REFERENCE_MISMATHCHES:case r.dsRead.errors.save.DESIGN_REFERENCE_MISMATCHES:case r.dsRead.errors.save.PROPERTY_REFERENCE_MISMATCHES:case r.dsRead.errors.save.CONNECTION_LIST_REFERENCE_MISMATCHES:case r.dsRead.errors.save.STYLE_REFERENCE_MISMATCHES:var s=U.partial(h,t);u=window.setInterval(s,V.SAVE_PUBLISH.VALIDATION_ERROR_POPUP_INTERVAL),s(t);break;case r.dsRead.errors.save.SAVE_DISABLED_IN_DOCUMENT_SERVICES:alert("SAVE IS DISABLED.\nIn order to prevent accidental changes for user sites, your editor has been opened with the save/autosave disabled.");break;default:S(e,k.SAVE_ERROR_DEFAULT_PANEL_DATA)}}function h(e){if(!D([l.VALIDATION_ERROR,l.SAVE_FAILED])){r.bi.event(w.events.DATA_CORRUPTION_MESSAGE,{date_corruption_type:e});var t=B.windowInteractionUtils.reloadPageWithoutQuestion,s=U.assign({},k.VALIDATION_ERROR,{onConfirm:t,errorType:e});r.panelManager.openPanel(l.VALIDATION_ERROR,s,!0)}}function m(i){var a=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};return new Promise(function(e,t){var s="autosave"===i||a.rejectOnConcurrentSaveCancel?function(){return t(new Error(r.dsRead.errors.save.CONCURRENT_SAVE))}:e,n=U.partial(g,e,t,i,a);r.panelManager.openPanel(l.CONCURRENT_SAVE,{overrideSaveMethod:n,onCancel:s,origin:i},!0)})}function S(e,t){var s=w.events.save.saveFailed,n=U.get(r.savePublish.getSiteState(),"isFirstSave"),i={errorCode:e&&M.extractDocumentErrorCode(e),biConfirm:n?s.First_Save_error_work_not_saved_error_ok_click:null,biHelp:n?s.First_Save_error_work_not_saved_error_help_center_link_click:null,biCancel:n?s.First_Save_error_work_not_saved_error_close_click:null},a=U({}).assign(t).defaults(k.SAVE_ERROR_DEFAULT_PANEL_DATA).assign(i).value();r.panelManager.openPanel(l.SAVE_FAILED,a,!0)}function _(n,i,a){return new Promise(function(e){var t=x.getOverridingSiteWasSavedPanel(o.getState());if(!r.account.isUserOwner()||r.wixStores.isSiteInWixStoreTestDrive()||U.get(t,"disabled"))e();else{var s=U.merge({},r.savePublish.getSiteState(),n);s.overrideTitle=i,s.overrideSubtitle=a,s.callback=e,r.panelManager.openPanel(l.SITE_WAS_SAVED,s,!0)}})}function E(i,a){return new Promise(function(e,t){i=U(i).pick(["overrideTitle","overrideSubtitle","overrideOnCancel","origin"]).assign({defaultSiteName:a?p():r.siteName.get(),freeDomainPrefix:F.getFreeDomainPrefix(o.getState(),r.dsRead),connectDomainHandler:U.partial(f,i,e,t,a),freeDomainHandler:U.partial(v,i,e,t,a)}).value();var s=x.getOverridingDomainPanel(o.getState()),n=U.get(s,"panelName",null);r.panelManager.openPanel(n||l.CHOOSE_DOMAIN,i,!0)})}function P(s){return new Promise(function(e){var t=r.savePublish.getSiteState();r.panelManager.openPanel("savePublish.panels.connectDomain",{title:"SAVE_SITE_SAVED_TITLE_TITLE",subtitle:"PREMIUM_TITLE_SUBTITLE",onConnectDomainFlowEnded:U.partial(e,s),isFirstSave:t.isFirstSave,isFirstPublish:!t.isSitePublished,isPremium:t.isSitePremium,flowId:V.CONNECT_DOMAIN.FLOWS.SAVE},!0)})}function v(e,t,s,n,i){N(i,e.origin,e,n).then(function(e){if(!e.preventSiteWasSavedPanel)return _()}).then(t).catch(s)}function b(i){return new Promise(function(s,n){r.site.getSiteDomainInfo(function(e){var t={isDomainConnected:e.isDomainConnected,isSitePremium:e.isSitePremium};e.isDomainConnected&&e.isSitePremium&&e.sitePublishedDomain&&(t.domain=e.sitePublishedDomain,r.dsActions.generalInfo.setPublicUrl(e.sitePublishedDomain)),r.savePublish.setSitePremiumState(t),i.preventSiteWasSavedPanel?s(i):_(t,a.SITE_SAVED_WELCOME_BACK_TITLE,a.SITE_SAVED_WELCOME_BACK_SUBTITLE).then(s).catch(n)},function(){i.preventSiteWasSavedPanel?s(i):_().then(s)})})}function f(e,t,s,n){N(p(),e.origin,e,n).then(P).then(b).then(t).catch(s)}function I(e,s,n){if(n=n||{},r.savePublish.isSaveInProgress())return Promise.reject();function i(){r.savePublish.setSaveProgress(!1),r.bi.tryFlushingConditionedEvents()}return r.savePublish.setSaveProgress(!0),window.clearInterval(u),r.savePublish.save(e,s,n).then(function(e){return i(),("publish"===s||n.isPublish)&&H.isOpen("se_fixPublishFlow")?{preventSiteWasSavedPanel:!0}:e||{}}).catch(function(e){i();var t=M.extractDocumentErrorType(e);if(t===r.dsRead.errors.save.CONCURRENT_SAVE)return m(s,n).then(function(){return{preventSiteWasSavedPanel:!0}});throw d(e,t),e})}function g(e,t,s,n){"autosave"===s&&B.fedopsLogger.interactionStarted(B.fedopsLogger.INTERACTIONS.UI_SAVE),I(!0,s,n).then(function(e){if(!e.preventSiteWasSavedPanel)return _()}).then(e).catch(t)}function N(s,e,t,n){if(!r.savePublish.isSaveInProgress())return n?r.siteName.set(s):r.siteName.rename(s),I(!0,e,t).then(function(e){return function(){var e=r.dsRead.generalInfo.getSiteId(),t=r.dsRead.generalInfo.getMetaSiteId(),s=B.url.parseUrl(window.location.href).query;delete s.siteId,s.metaSiteId=t;var n=U.template(c)({siteId:e});n=B.url.setUrlParams(n,s),B.windowInteractionUtils.replaceState({},"",n)}(),0<U.size(r.dsRead.wixapps.classics.getAllAppPartComps("blog"))&&r.dsActions.wixapps.classics.reloadApp("blog"),e},function(e){var t;throw t=e,r.dsRead.errors.save.SITE_NAME_TAKEN===M.extractDocumentErrorType(t)&&r.siteName.markAsUsed(s),e})}function T(){return new Promise(function(e){r.panelManager.openPanel(l.ON_BOARDING_MIGRATION,{onConfirm:e,onCancel:U.partial(e,"back_to_ADI")},!0)})}function A(e){return!e&&r.dsRead.generalInfo.isSiteFromOnBoarding()&&!r.dsRead.generalInfo.isTemplate()}function O(){if(H.isOpen("se_fixPublishFlow")){var e=V.USER_PREFS.SAVE.SHOW_CONNECT_DOMAIN;return y.editorPlugins.userPreferences.selectors.getSessionUserPreferences(e)(r.store.getState())}}function C(e){if(H.isOpen("se_fixPublishFlow")){var t=V.USER_PREFS.SAVE.SHOW_CONNECT_DOMAIN;r.store.dispatch(y.editorPlugins.userPreferences.actions.setSessionUserPreferences(t,e))}}function R(t){var e=(t=t||{}).origin||"";if(!r.savePublish.canSaveOrPublish())return i.error("Site is being saved or published!"),Promise.resolve();if(H.isOpen("se_obMigrationFlow")&&!U.get(t,"forceOBMigration")&&A(t.getBackToADI))return T().then(function(e){if("back_to_ADI"!==e)return t.onBoarding=!1,R(U.defaults({forceOBMigration:!0},t))});var s=r.savePublish.getSiteState();return s&&s.isFirstSave||O()?H.isOpen("googleDomain")&&F.doesUserOwnGoogleDomain()?N(p(),e,t,!0).then(function(e){if(!e.preventSiteWasSavedPanel)return _()}):E(t,s.isFirstSave).then(function(){C(!1)}):I(!1,t.origin,t).then(function(e){var t;if(t=void 0,!(H.isOpen("se_postSavePublishPreference")?(t=y.editorPlugins.userPreferences.selectors.getSiteUserPreferences(V.USER_PREFS.SAVE.SITE_SAVED_DONT_SHOW_AGAIN)(r.store.getState()),n>Date.now()-t):t=!0===y.editorPlugins.userPreferences.selectors.getSessionUserPreferences(V.USER_PREFS.SAVE.SITE_SAVED_DONT_SHOW_AGAIN)(r.store.getState()))&&!e.preventSiteWasSavedPanel)return _({},"SAVE_SITE_SAVED_SMALL_TITLE_TITLE","SAVE_SITE_SAVED_SMALL_TITLE_SUBTITLE")})}function D(t){return U.some(r.panelManager.getOpenPanels(),function(e){return U.includes(t,e.name)})}function L(e,t){var s=r.dsRead.pages.background.get(e,t);s&&!s.isPreset&&(s.isPreset=!0,r.pages.background.update(e,s,t))}return{save:R,saveInBackground:function t(s,n){if(n=n||{},H.isOpen("se_obMigrationFlow")&&!U.get(n,"forceOBMigration")&&A(n.getBackToADI))return T().then(function(e){if("back_to_ADI"!==e)return n.onBoarding=!1,t(s,U.defaults({forceOBMigration:!0},n))});H.isOpen("se_backToADIFromEditor")&&n.getBackToADI&&(n.onBoarding=!0);var e=r.savePublish.getSiteState();return e&&e.isFirstSave?N(p(),s,n,!0).then(function(){C(!0)}):n.isPublish&&O()?E(n,e.isFirstSave).then(function(){C(!1)}):I(!1,s,n)},saveAsTemplate:function(e,t){var s;function n(e,t){r.savePublish.setSaveProgress(!1),r.savePublish.setPublishProgress(!1),e&&e(t)}r.dsRead&&r.dsRead.generalInfo&&r.dsRead.generalInfo.getUserInfo().isStudio?(r.savePublish.isSaveInProgress()&&t(),r.savePublish.setSaveProgress(!0),r.savePublish.setPublishProgress(!0),s=r.dsRead.pages.getPageIdList(),U.forEach(s,function(e){L(e,"desktop"),L(e,"mobile")}),r.savePublish.saveAsTemplate(U.partial(n,e),U.partial(n,t))):i.info("Failed saving as template. User has no permissions to save as template")},setTimerForSaveReminder:U.once(function(){var a=[l.SAVE_REMINDER,l.CHOOSE_DOMAIN];window.setTimeout(function e(){if(r.dsRead.generalInfo.isFirstSave()&&r.savePublish.isSaveReminderPanelEnabled()){var t=r.savePublish.canSaveOrPublish(),s=D(a),n=r.zoomMode.isInZoomMode(),i=r.mobile.mobileWizard.isEnabled();!t||s||n||i||(r.panelManager.openPanel(l.SAVE_REMINDER,{saveMethod:U.partial(R,r,{origin:"remember_to_save_active_save_popup"})},!0),window.clearTimeout(o)),window.setTimeout(e,V.SAVE_PUBLISH.SAVE_REMINDER_TIMEOUT)}},V.SAVE_PUBLISH.SAVE_REMINDER_TIMEOUT);var o=window.setTimeout(function e(){r.dsRead.generalInfo.isFirstSave()&&(!r.savePublish.canSaveOrPublish()||D(a)||r.zoomMode.isInZoomMode()||(t.tooltipManager.showForDuration("save-button-tooltip",V.SAVE_PUBLISH.SAVE_TOOLTIP_DURATION),r.bi.event(w.events.save.saveReminder.REMINDER_DISPLAYED,{origin:"save tool-tip"})),o=window.setTimeout(e,V.SAVE_PUBLISH.SAVE_TOOLTIP_TIMEOUT))},V.SAVE_PUBLISH.SAVE_TOOLTIP_TIMEOUT);H.isOpen("se_obMigrationFlow")&&U.invoke(r,"dsRead.generalInfo.isSiteFromOnBoarding")&&window.setTimeout(function(){t.tooltipManager.showForDuration("save-button-tooltip",V.SAVE_PUBLISH.SAVE_TOOLTIP_DURATION)},2e3)}),openConcurrentSavePanel:m,displayFailurePanelMatchingAnErrorType:d}}}),define("savePublish/managers/saveManagerWrapper",["lodash","util","savePublish/managers/saveManager"],function(r,l,e){"use strict";return function(i,a){var o=e(i,a);return{save:function(e){(e=e||{}).origin=e.origin||"";var t=e.callback||r.noop,s=e.onError||r.noop;"publish"!==e.origin&&l.fedopsLogger.interactionStarted(l.fedopsLogger.INTERACTIONS.UI_SAVE),o.save(e).then(function(){t(),"publish"!==e.origin&&l.fedopsLogger.interactionEnded(l.fedopsLogger.INTERACTIONS.UI_SAVE)}).catch(function(e){l.ravenUtils.captureError(r.isError(e)?e:r.values(e)[0],{tags:{user_save:!0}}),s(e)})},saveInBackground:function(e,t,s,n){i.savePublish.canSaveOrPublish()?((n=n||{}).isPublish||(l.ravenUtils.breadcrumb({message:"application triggered save",data:{origin:s,options:n}}),l.fedopsLogger.interactionStarted(l.fedopsLogger.INTERACTIONS.BG_SAVE),n.isSilent=!0),o.saveInBackground(s,n).then(function(){e(),n.isPublish||l.fedopsLogger.interactionEnded(l.fedopsLogger.INTERACTIONS.BG_SAVE)}).catch(function(e){n.isPublish?l.ravenUtils.captureError(r.isError(e)?e:r.values(e)[0],{tags:{publish_save:!0}}):l.ravenUtils.captureError(r.isError(e)?e:r.values(e)[0],{tags:{background_save:!0}}),t(e)})):a.error("Site is being saved or published!")},saveAsTemplate:o.saveAsTemplate,setTimerForSaveReminder:r.once(o.setTimerForSaveReminder),openConcurrentSavePanel:function(t,s,e,n){o.openConcurrentSavePanel(e,n).then(function(e){l.fedopsLogger.interactionEnded(l.fedopsLogger.INTERACTIONS.UI_SAVE),t(e)}).catch(function(e){s(e)})},displayFailurePanelMatchingAnErrorType:o.displayFailurePanelMatchingAnErrorType}}}),define("savePublish/constants/constants",["experiment"],function(e){"use strict";var t=e.getValue("se_autosaveActionCount"),s=e.getValue("se_saveAfterAutosaveCount"),n=e.getValue("se_autosaveInterval");return t=i(t,7),s=i(s,10),{ERROR_CODES:{SAVE_PUBLISH_DISABLED_ON_SERVER:-10132},SAVE:{SAVE_FAILED_HELP_LINK:"8045e8e4-6f47-4913-8d74-6239f21fffec"},AUTOSAVE:{AUTOSAVE_TIMEOUT:n=i(n,30),AUTOSAVE_ACTION_COUNT:t,SAVE_AFTER_AUTOSAVE_COUNT:s,DEBOUNCE_WAIT:2},RENAME:{ERRORS:{SITE_NAME_TAKEN:-40003}}};function i(e,t){return/^config\d+$/.test(e)?Number(e.replace("config","")):t}}),define("savePublish/managers/autosaveManager",["lodash","util","experiment","constants","stateManagement","savePublish/constants/constants","coreBi","savePublish/utils/failedPanelUtil"],function(_,E,e,P,v,b,f,I){"use strict";return function(r){var i=P.PROGRESS_STATUS;function l(){var e=E.url.isQA(),t="true"===E.url.getParameterByName("forceAutosave");return e&&!t}function a(e){return _(["CONCURRENT_SAVE","CONCURRENT_AUTO_SAVE","SITE_STALE_STATE_FROM_AUTO_SAVE"]).map(_.propertyOf(r.documentServices.errors.save)).includes(I.extractDocumentErrorType(e))}function o(e,t){var s=void 0;s="autosave"===e?t?"autosaveSuccessCount":"autosaveFailCount":t?"autoFullSaveSuccessCount":"autoFullSaveFailCount",_.isNaN(Number(window.testApi[s]))&&(window.testApi[s]=0),window.testApi[s]++}function t(){r.savePublish.setDiffSaveProgress(!0),m()&&r.updateState({savingStatus:i.IN_PROGRESS})}function s(e,t){var s=e?i.DONE_FAILED:i.DONE_SUCCESS,n=e?i.IDLE:i.IDLE_SAVED;r.savePublish.setDiffSaveProgress(!1),m()&&(r.updateState({savingStatus:s}),window.setTimeout(function(){r.updateState({savingStatus:n})},P.SAVE_PUBLISH.DURATION_TO_SHOW_RESULT)),e&&a(e)&&r.saveManager.openConcurrentSavePanel(_.noop,d,"autosave"),r.store.dispatch(v.editorPlugins.leavePopup.actions.setLeavePopup(!!e)),r.bi.event(f.events.save.autosave.DIFF_SAVED,{type:t,success:!e}),E.url.isQA()&&"undefined"!=typeof window&&window.testApi&&o("autosave",!e),u()}function n(){m()&&(r.savePublish.setSaveProgress(!0),r.updateState({savingStatus:i.IN_PROGRESS}))}function c(e){var t=e?i.DONE_FAILED:i.DONE_SUCCESS,s=e?i.IDLE:i.IDLE_SAVED;m()&&(r.savePublish.setSaveProgress(!1),r.updateState({savingStatus:t}),r.store.dispatch(v.editorPlugins.leavePopup.actions.setLeavePopup(!!e)),window.setTimeout(function(){r.updateState({savingStatus:s})},P.SAVE_PUBLISH.DURATION_TO_SHOW_RESULT)),e&&(a(e)?r.saveManager.openConcurrentSavePanel(_.noop,d,"autosave"):r.saveManager.displayFailurePanelMatchingAnErrorType(e)),E.url.isQA()&&"undefined"!=typeof window&&window.testApi&&o("autoFullSave",!e),u()}function u(){r.bi.tryFlushingConditionedEvents()}function p(e){return _.assign({},{enabled:!0},{onDiffSaveStarted:t,onDiffSaveFinished:s,onPartialSaveStarted:n,onPartialSaveFinished:c},b.AUTOSAVE,e)}function d(){E.windowInteractionUtils.reloadPageWithoutQuestion()}function h(){if(m()){var e=P.ROOT_COMPS.TOPBAR.DROP_PANELS.CUSTOM.AUTO_SAVE;r.topBarMenuBar.openDropDown(e),window.setTimeout(r.topBarMenuBar.closeDropDown.bind(r,e),P.SAVE_PUBLISH.SITE_AUTO_SAVED_TOOLTIP_DURATION)}}function m(){var e=r.documentServices;if(!e)return!1;var t=v.editorPlugins.userPreferences.selectors.getSiteUserPreferences(P.USER_PREFS.SAVE.AUTOSAVE_ENABLED)(r.store.getState()),s=e.getAutoSaveInfo(),n=s&&s.shouldAutoSave,i=S();return t&&n&&!i}function S(){return!e.isOpen("se_autosavePlatform")&&(r.dsRead.wixCode.isProvisioned()||r.developerMode.isEnabled())}return{init:function(e,t){var s,n=!e||e.enable,i=l()||S()||(s=v.editorPlugins.userPreferences.selectors.getSiteUserPreferences(P.USER_PREFS.SAVE.AUTOSAVE_ENABLED)(r.store.getState()),_.isUndefined(s)&&(r.store.dispatch(v.editorPlugins.userPreferences.actions.setSiteUserPreferences(P.USER_PREFS.SAVE.AUTOSAVE_ENABLED,!0)),s=!0),!s);if(n&&i)return!1;var a=p(e);r.dsActions.initAutosave(a);var o=r.dsRead.generalInfo.isSiteFromOnBoarding();return!t&&a.enabled&&m()&&!o&&h(),a},getAutosaveConfig:p,showSiteAutoSavedTooltipIfNeeded:h,shouldShowAutosaveUI:m,isAutomationWithoutAutosave:l,autosaveStatusTooltip:function(e){var t=r.dsRead.getAutoSaveInfo(),s=t&&t.shouldAutoSave,n=S();if(s&&!n){var i=e?P.ROOT_COMPS.TOPBAR.DROP_PANELS.CUSTOM.DISABLE_AUTO_SAVE:P.ROOT_COMPS.TOPBAR.DROP_PANELS.CUSTOM.ENABLE_AUTO_SAVE;r.topBarMenuBar.openDropDown(i),window.setTimeout(r.topBarMenuBar.closeDropDown.bind(r,i),5e3)}}}}}),define("savePublish/managers/mockSaveManager",["lodash","savePublish/constants/savePublishErrorPanelData","constants","coreUtilsLib"],function(a,e,t,n){"use strict";var i="http://www.wix.com/",o={CHOOSE_DOMAIN:"savePublish.panels.save.chooseDomainPanel",SITE_WAS_SAVED:"savePublish.panels.save.siteWasSavedPanel",SAVE_FAILED:"savePublish.panels.common.failPanel",CONCURRENT_SAVE:"savePublish.panels.save.concurrentSavePanel"},r=null,l=null;function c(){for(var e=r.dsRead.siteName.getUsed(),t=r.dsRead.siteName.get(),s=t.slice(0,20),n=1;a.includes(e,s);){var i="-"+n;s=t.slice(0,20-i.length)+i,n++}return s}function u(){r.panelManager.openPanel(o.SAVE_FAILED,e.SAVE_ERROR_DEFAULT_PANEL_DATA,!0)}function p(e,t){var s=a.clone(l);s.isMockSave=!0,s.overrideTitle=e,s.overrideSubtitle=t,r.panelManager.openPanel(o.SITE_WAS_SAVED,s,!0)}function d(e){var t;l.shouldSaveSucceed?(s(),t={domain:i+e},l=a.merge(l||{},t),p()):u()}function h(){l.shouldSaveSucceed?(s(),function(){r.panelManager.openPanel("savePublish.panels.connectDomain",{title:"SAVE_SITE_SAVED_TITLE_TITLE",subtitle:"PREMIUM_TITLE_SUBTITLE",onConnectDomainFlowEnded:p.bind(this,"SAVE_SITE_SAVED_WELCOME_BACK_TITLE","SAVE_SITE_SAVED_WELCOME_BACK_SUBTITLE"),isFirstSave:!0,isFirstPublish:!0,isPremium:l.isSitePremium,flowId:t.CONNECT_DOMAIN.FLOWS.SAVE},!0)}()):u()}function s(){n.log.info("First Save Was Performed!")}return{save:function(e){(r=e).panelManager.openPanel("savePublish.panels.save.saveConfigurationPanel",{onConfirm:function(e){var t,s;e.isDomainConnected||(e.domain=i+c()),t=e,l=a.clone(t),e.isFirstSave?(s={defaultSiteName:c(),freeDomainPrefix:i,connectDomainHandler:h,freeDomainHandler:d},r.panelManager.openPanel(o.CHOOSE_DOMAIN,s,!0)):e.shouldSaveSucceed?(n.log.info("Save Was Performed!"),p("SAVE_SITE_SAVED_SMALL_TITLE_TITLE","SAVE_SITE_SAVED_SMALL_TITLE_SUBTITLE")):u()}},!0)}}}),define("savePublish/panels/publish/publishInnerPanelTypes",["constants"],function(){"use strict";return{EMPTY:{name:"EMPTY"},SHOUTOUT:{name:"SHOUTOUT",userPref:!0},CONNECT_DOMAIN:{name:"CONNECT_DOMAIN",userPref:!0},GROW_BUSINESS:{name:"GROW_BUSINESS",userPref:!0}}}),define("savePublish/managers/publishManager",["lodash","util","coreUtilsLib","savePublish/utils/failedPanelUtil","savePublish/constants/savePublishErrorPanelData","savePublish/panels/publish/publishInnerPanelTypes","stateManagement","coreBi","constants","experiment"],function(N,u,p,d,h,T,A,m,O,C){"use strict";var R=A.editorPlugins.domain.selectors,D=A.savePublish.selectors,L=A.savePublish.actions;return function(P){var v=P.store,b="savePublish.panels.publish.publishSuccessPanel",i="savePublish.panels.common.failPanel";function s(){u.fedopsLogger.interactionEnded(u.fedopsLogger.INTERACTIONS.USER_PUBLISH_SITE)}function n(e){var t;P.savePublish.canSaveOrPublish()&&(C.isOpen("se_publishNotAlwaysSaving")&&!P.dsRead.generalInfo.isFirstSave()&&u.fedopsLogger.interactionStarted(u.fedopsLogger.INTERACTIONS.USER_PUBLISH_SITE),P.account.isUserOwner()&&!P.wixStores.isSiteInWixStoreTestDrive()?(P.savePublish.setPublishProgress(!0),D.getIsDealerLoaded(v.getState())||r(),t={isFirstSave:P.dsRead.generalInfo.isFirstSave(),isPremiumUser:P.site.isPremium(),isFirstPublish:!P.dsRead.generalInfo.isSitePublished()},P.savePublish.publish(e).then(function(){var n,e;n=function(e){c(N.assign(t,e)),l()},e=l,P.site.getSiteDomainInfo(function(e){var t=e.isDomainConnected,s=e.sitePublishedDomain;n({sitePremiumDomain:s,isDomainConnected:t})},e),s()},a)):P.savePublish.publish().then(function(){l(),s()},a))}function a(e){switch(d.extractDocumentErrorType(e)){case P.dsRead.errors.save.SAVE_PUBLISH_DISABLED_ON_SERVER:t(e,h.PUBLISH_DISABLED_ON_SERVER_PANEL_DATA);break;default:t(e,h.PUBLISH_ERROR_DEFAULT_PANEL_DATA)}l()}function o(e){var t=e.isUsingDealer,s=e.description,n=e.stage;P.bi.event(m.events.dealer.content_presented_by_dealer,{description:t?"":s,content_presented_by_dealer:t,stage:n,category:"upgrade",panel_name:b})}function r(){N.get(P.wixDealerClientApi,"DealerAssetsLoader")&&P.dsRead.generalInfo.getMetaSiteId()&&u.dealerUtils.loadDealerAsset(P.wixDealerClientApi,u.dealerUtils.bannerPositions.POST_PUBLISH,null,P.site.getMetaSiteId()).then(function(e){var t=e.assetExist();o({isUsingDealer:t,stage:"prefetch",description:t?"":"banner data pre fetch asset does not exist error"}),v.dispatch(L.setIsDealerLoaded(t))}).catch(function(e){o({isUsingDealer:!1,stage:"prefetch",description:"banner data pre fetch "+N.get(e,"message","unknown")+" error"})})}function l(){P.savePublish.setPublishProgress(!1)}function t(e,t){var s={errorCode:d.extractDocumentErrorCode(e),biConfirm:m.events.publish.Publish_Work_not_Published_Error_ok_Click,biHelp:m.events.publish.Publish_Work_not_Published_Error_Help_Center_Link_Click},n=N.chain(t).clone().defaults(h.PUBLISH_ERROR_DEFAULT_PANEL_DATA).assign(s).value();P.panelManager.openPanel(i,n,!0)}function c(e){var t=P.dsRead.generalInfo.getPublicUrl()||R.getFreeDomainPrefix(v.getState(),P.dsRead)+P.siteName.get();t=e.isDomainConnected?e.sitePremiumDomain:t;var s,n,i,a,o,r,l,c,u,p,d,h,m=O.USER_PREFS.PUBLISH,S=function(){var e=O.USER_PREFS.PUBLISH;if(C.isOpen("se_postSavePublishPreference")){var t=A.editorPlugins.userPreferences.selectors.getSiteUserPreferences(e.POST_PUBLISH_DONT_SHOW_AGAIN)(P.store.getState());return Date.now()-t<2592e6}return A.editorPlugins.userPreferences.selectors.getSessionUserPreferences(e.POST_PUBLISH_DONT_SHOW_AGAIN)(P.store.getState())}(),_=function(e,t){var s=T.EMPTY;if(!e.isPremiumUser&&e.isDomainConnected)return s;if(f(e))s=T.CONNECT_DOMAIN;else{var n=I(e,t);if(n.length){var i=D.getPublishPanelPromotionIndex(P.store.getState());s=n[i%n.length]||T.EMPTY}}return s}(e,S);if(f(e)||(s=e,n=S,i=P.store,a=i.getState,o=i.dispatch,r=I(s,n),l=(D.getPublishPanelPromotionIndex(a())+1)%(r.length||1),o(L.setPublishPanelPromotionIndex(l))),N.isEqual(_,T.EMPTY)||S)C.isOpen("se_fixPublishFlow")&&N.forEach(P.sitePublishedCallbacks,function(e){e()});else{var E=(u=_,p=t,d=m,h={isFakePanel:(c=e).isFakePublish,contentPanelType:u,configuration:c,currentDomain:P.site.getCurrentSiteDomain(),setDontShowPanelValue:function(e){return P.store.dispatch(A.editorPlugins.userPreferences.actions.setSessionUserPreferences(d.POST_PUBLISH_DONT_SHOW_AGAIN,e))},sitePublicUrl:p,closePanel:g},D.getIsDealerLoaded(v.getState())&&P.isDealerCssLoaded&&(h.dealerViewer=P.wixReactDealerViewer.DealerViewer),C.isOpen("se_postSavePublishPreference")&&(h.setDontShowPanelValue=function(e){e&&P.store.dispatch(A.editorPlugins.userPreferences.actions.setSiteUserPreferences(d.POST_PUBLISH_DONT_SHOW_AGAIN,Date.now()))}),h);P.panelManager.openPanel(b,E,!0)}}function f(e){return(C.isOpen("se_disableRotationOfPostPublishMessages")||e.isFirstPublish)&&!e.isDomainConnected}function I(e,t){var s,n,i,a,o,r,l=[],c=(n=t,!(s=e).isDomainConnected&&(!n||s.isFakePublish)),u=(a=t,!(i=e).isDomainConnected&&(!a||i.isFakePublish)),p=(r=t,(o=e).isPremiumUser&&o.isDomainConnected&&(!r||o.isFakePublish));return c&&l.push(T.CONNECT_DOMAIN),u&&l.push(T.SHOUTOUT),p&&l.push(T.GROW_BUSINESS),l}function g(){return P.panelManager.closePanelByName(b)}return D.getIsDealerLoaded(v.getState())||r(),{publish:n,saveAndPublish:function(e){var t=D.getOverridingSaveAndPublish(P.store.getState());if(t)t(e);else if(u.fedopsLogger.interactionStarted(u.fedopsLogger.INTERACTIONS.USER_PUBLISH_SITE),u.fedopsLogger.interactionStarted(u.fedopsLogger.INTERACTIONS.DEALER_IN_POST_PUBLISH),P.savePublish.canSaveOrPublish())if(P.dsRead.generalInfo.isFirstSave()){var s={overrideTitle:"PUBLISH_BEFORE_SAVE_CHOOSE_DOMAIN_TITLE",overrideSubtitle:"PUBLISH_BEFORE_SAVE_CHOOSE_DOMAIN_SUBTITLE",callback:n,origin:O.CONNECT_DOMAIN.FLOWS.PUBLISH,isPublish:!0};P.saveManager.save(s)}else P.saveManager.saveInBackground(n,a,e,{isPublish:!0})},configureMockPostPublish:function(){P.panelManager.openPanel("savePublish.panels.publish.config.publishConfigurationPanel",{onConfirm:function(e){(e=N.assign({},e,{isFakePublish:!0})).shouldPublishSucceed&&!e.isSiteContributor?c(e):e.shouldPublishSucceed&&e.isSiteContributor?(p.log.info("Contributors dont get to see any post operations except failure."),l()):t()}})}}}}),define("savePublish/panels/connectDomain/connectDomainPanel.rt",["react","lodash","panels","util","baseUI","santa-editor-symbols"],function(e,t,s,n,i,a){"use strict";return function(){return e.createElement(s.frames.focusPanelFrame,{className:"connect-domain-panel save-publish-panel",panelName:this.props.panelName,shouldHideHeader:!0,frameClassName:"save-publish-panel-frame",keyboardShortcuts:this.getKeyboardShortcuts()},e.createElement("header",{className:"save-publish-panel-header"},e.createElement("button",{className:"close",onClick:function(){this.onClose(!1)}.bind(this)},e.createElement(a.symbol,{name:"headerCloseButton"})),e.createElement("span",{className:"title"},this.translateIfNeeded(this.props.title)),e.createElement("span",{className:"subtitle"},this.translateIfNeeded(this.props.subtitle))),e.createElement("div",{className:"actions"},e.createElement("a",{className:"action",onClick:this.connectToNewDomain,onMouseEnter:function(){this.hoverOnAction(1)}.bind(this),onMouseLeave:this.resetHoverOnAction},e.createElement("div",{className:"action-graphics"},e.createElement(i.symbol,{name:"connectNewDomain"})),e.createElement("div",{className:"action-title"},this.translateIfNeeded("PREMIUM_BUTTON_1")),this.isActionHovered(1)?null:e.createElement("div",{key:"optionArrow",className:"action-arrow"},e.createElement(i.symbol,{name:"arrowWithCircle"})),this.isActionHovered(1)?e.createElement("div",{key:"optionLink",className:"action-arrow"},e.createElement(i.symbol,{name:"openLinkInWindow"})):null),e.createElement("a",{className:"action",onClick:this.connectExistingDomain,onMouseEnter:function(){this.hoverOnAction(2)}.bind(this),onMouseLeave:this.resetHoverOnAction},e.createElement("div",{className:"action-graphics"},e.createElement(i.symbol,{name:"connectDomainLight"})),e.createElement("div",{className:"action-title"},this.translateIfNeeded("PREMIUM_BUTTON_2")),this.isActionHovered(2)?null:e.createElement("div",{key:"optionArrow",className:"action-arrow"},e.createElement(i.symbol,{name:"arrowWithCircle"})),this.isActionHovered(2)?e.createElement("div",{key:"optionLink",className:"action-arrow"},e.createElement(i.symbol,{name:"openLinkInWindow"})):null)),e.createElement("div",{className:"connect-domain-panel-footer"},e.createElement(i.button,{type:"button",label:"PREMIUM_BUTTON_LABEL",className:"maybe-later-button",onClick:this.maybeLater})))}}),define("savePublish/panels/connectDomain/connectDomainPanel",["create-react-class","prop-types","zepto","lodash","core","util","coreBi","constants","savePublish/panels/connectDomain/connectDomainPanel.rt"],function(e,t,s,n,i,a,o,r,l){"use strict";return e({displayName:"connectDomainPanel",mixins:[i.mixins.editorAPIMixin,a.translationMixin],propTypes:{isPremium:t.bool.isRequired,isFirstSave:t.bool,isFirstPublish:t.bool,title:t.string,subtitle:t.string,panelName:t.string,onConnectDomainFlowEnded:t.func,flowId:t.oneOf(n.values(r.CONNECT_DOMAIN.FLOWS)).isRequired},getInitialState:function(){return{actionIndexHovered:-1}},connectToNewDomain:function(){var e="CONNECT_NEW_DOMAIN",t=o.events.save.siteWasSavedPanel.CONNECT_NEW_DOMAIN_CLICKED,s=this.openUpgrade.bind(this,e);this.props.isPremium&&(s=this.openConnectDomainInWindow.bind(this,e)),this.connectDomain(t,s)},connectExistingDomain:function(){var e="CONNECT_EXISTING_DOMAIN",t=o.events.save.siteWasSavedPanel.CONNECT_EXISTING_DOMAIN_CLICKED,s=this.openUpgrade.bind(this,e);this.props.isPremium&&(s=this.openConnectDomainInWindow.bind(this,e)),this.connectDomain(t,s)},connectDomain:function(e,t){this.props.isFirstSave&&this.getEditorAPI().bi.event(e);var s=this.listenToTabFocusIfNeeded();t.call(this),this.onClose(s)},listenToTabFocusIfNeeded:function(){if(this.props.onConnectDomainFlowEnded){var e=function(){this.getWindow().off("focus",e),this.props.onConnectDomainFlowEnded()}.bind(this);return this.getWindow().on("focus",this.onEditorFocus),!0}return!1},onEditorFocus:function(){this.getWindow().off("focus",this.onEditorFocus),this.props.onConnectDomainFlowEnded()},getReferralCode:function(e){var t="edhtml_";switch(this.props.flowId){case r.CONNECT_DOMAIN.FLOWS.SAVE:t+="SAVE_FLOW_",t+=this.props.isFirstSave?"FIRST_SAVE_":"SECOND_SAVE_",t+=e;break;case r.CONNECT_DOMAIN.FLOWS.TOP_BAR:t+="TOP_BAR_SITE_MENU_CONNECT_DOMAIN_"+e;break;case r.CONNECT_DOMAIN.FLOWS.PUBLISH:t+="PUBLISH_FLOW_",t+=this.props.isFirstPublish?"FIRST_PUBLISH_":"SECOND_PUBLISH_",t+=e;break;case r.CONNECT_DOMAIN.FLOWS.PUBLISH_BUTTON:t+="PUBLISH_FLOW_CONNECT_BUTTON_",t+=this.props.isFirstPublish?"FIRST_PUBLISH_":"SECOND_PUBLISH_",t+=e;break;default:t=null}return t},openUpgrade:function(e){var t=this.getReferralCode(e);this.getEditorAPI().account.upgrade(t)},openConnectDomainInWindow:function(e){var t=this.createURLWithParams("https://premium.wix.com/wix/api/domainConsole?siteGuid=<%= siteGUID %>&referralAdditionalInfo=<%= referralInfo %>",e);window.open(t)},createURLWithParams:function(e,t){var s=this.getReferralCode(t);return n.template(e)({siteGUID:this.getEditorAPI().dsRead.generalInfo.getSiteId(),referralInfo:s})},maybeLater:function(){this.getEditorAPI().bi.event(o.events.save.siteWasSavedPanel.First_Save_Dialog_2_maybe_later_click),this.onClose(!1)},onClose:function(e){this.getEditorAPI().panelManager.closePanelByName(this.props.panelName),!e&&this.props.onConnectDomainFlowEnded&&this.props.onConnectDomainFlowEnded()},getWindow:function(){return s(window)},resetHoverOnAction:function(){this.hoverOnAction(-1)},hoverOnAction:function(e){this.setState({actionIndexHovered:e})},isActionHovered:function(e){return this.state.actionIndexHovered===e},getKeyboardShortcuts:function(){var e=this;return{enter:function(){e.maybeLater()},esc:function(){e.onClose(!1)}}},render:l})}),define("savePublish/panels/connectDomain/connectDomainInProgress.rt",["react","lodash","panels","util","baseUI","santa-editor-symbols"],function(e,t,s,n,i,a){"use strict";return function(){return e.createElement(s.frames.focusPanelFrame,{className:"connect-domain-in-progress-panel save-publish-panel",panelName:this.props.panelName,shouldHideHeader:!0,frameClassName:"save-publish-panel-frame",keyboardShortcuts:this.getShortcuts()},e.createElement("div",{className:"save-publish-panel-header"},e.createElement("div",{className:"title"},n.translate("PUBLISH_HANGON_TITLE")),e.createElement("div",{className:"subtitle"},n.translate("PUBLISH_HANGON_SUBTITLE")),e.createElement("button",{className:"close-button",onClick:this.onClose},e.createElement(a.symbol,{name:"headerCloseButton"}))),e.createElement("div",{className:"panel-content"},e.createElement("div",{className:"content-top-part"},e.createElement("div",{className:"content-graphics"},e.createElement(i.symbol,{name:"hangon"})),e.createElement("div",{className:"content-top-message"},"\n                ",n.translate("PUBLISH_HANGON_MAIN_TEXT"),"\n                ",e.createElement("span",{className:"public-url"},this.props.connectedDomainURL))),e.createElement("div",{className:"content-bottom-message"},"\n            ",n.translate("PUBLISH_HANGON_MEANTIME_TEXT"),"\n            ",e.createElement("a",{className:"content-bottom-message-link",onClick:this.openWorkingURL},n.translate("PUBLISH_HANGON_CLICKING_HERE_LINK")))),e.createElement("div",{className:"connect-domain-panel-footer"},e.createElement(i.button,{type:"button",className:"maybe-later-button",label:"PUBLISH_HANGON_DONE_BUTTON",onClick:this.onClose})))}}),define("savePublish/panels/connectDomain/connectDomainInProgress",["create-react-class","prop-types","stateManagement","util","savePublish/panels/connectDomain/connectDomainInProgress.rt"],function(e,t,s,n,i){"use strict";var a=n.hoc.connect,o=e({displayName:"connectDomainInProgress",propTypes:{connectedDomainURL:t.string.isRequired,currentPublicURL:t.string.isRequired,panelName:t.string,closePanel:t.func.isRequired},getShortcuts:function(){return{esc:this.onClose,enter:this.onClose}},openWorkingURL:function(){window.open(this.props.currentPublicURL)},onClose:function(){this.props.closePanel()},render:i});return a([],void 0,function(e,t){return{closePanel:function(){e(s.editorPlugins.panels.actions.closePanelByNameAction(t.panelName))}}})(o)}),define("savePublish/panels/common/failPanel.rt",["react","lodash","util","baseUI","panels"],function(s,e,n,t,i){"use strict";return function(){return s.createElement(i.frames.messagePanelFrame,{panelName:this.props.panelName,className:"fail-panel",panelTitle:n.translate(this.props.titleKey),confirmLabel:this.getConfirmLabel(),onConfirm:this.onConfirm,onCancel:this.onCancel,footerText:this.props.showFooterText?this.getFooterText():null,keyboardShortcuts:this.getShortcuts()},s.createElement("div",{className:"content-wrapper"},s.createElement("div",{className:"icon"},s.createElement(t.symbol,{name:"plaster"})),-41218!==this.props.errorCode?s.createElement("div",{className:"textual",key:"errorNot-41218"},s.createElement("p",{className:"description",dangerouslySetInnerHTML:{__html:this.translateProp("description")}}),this.props.showSteps&&this.props.stepsTitle?s.createElement("div",{key:"stepsTitle",className:"steps-title"},this.translateProp("stepsTitle")):null,this.props.showSteps?s.createElement.apply(this,["ol",{key:"steps"},e.map(this.props.steps,function(e,t){return s.createElement("li",{key:e},n.translate(e))}.bind(this))]):null):null,-41218===this.props.errorCode?s.createElement("div",{className:"textual",key:"error-41218"},s.createElement("h3",{},n.translate("PUBLISH_ERROR_SITE_DELETED_TITLE")),s.createElement("p",{className:"description"},n.translate("PUBLISH_ERROR_SITE_DELETED_BODY"))):null))}}),define("savePublish/panels/common/failPanel",["lodash","react-dom-factories","create-react-class","prop-types","core","util","constants","savePublish/panels/common/failPanel.rt"],function(e,t,s,n,i,a,o,r){"use strict";return s({displayName:"failPanel",mixins:[i.mixins.editorAPIMixin],propTypes:{titleKey:n.string.isRequired,description:n.string.isRequired,stepsTitle:n.string,steps:n.array.isRequired,helpMessage:n.string.isRequired,helpLinkMessage:n.string.isRequired,helpLink:n.string.isRequired,errorCode:n.number,biEvent:n.object,biParams:n.object,failHelpId:n.string,biConfirm:n.object,biHelp:n.object,biCancel:n.object,onConfirm:n.func,confirmLabel:n.string,panelName:n.string,translateArgs:n.object},getDefaultProps:function(){return{showSteps:!0,showFooterText:!0,panelName:"savePublish.panels.common.failPanel",translateArgs:{}}},translateProp:function(e){return this.props[e]&&a.translationUtil.translateTemplate(this.props[e],this.props.translateArgs[e])},getShortcuts:function(){var e=this;return{esc:function(){e.getEditorAPI().panelManager.closePanelByName(e.props.panelName),e.onCancel()},enter:function(){e.getEditorAPI().panelManager.closePanelByName(e.props.panelName),e.onConfirm()}}},getErrorCodeMessage:function(){return void 0!==this.props.errorCode&&null!==this.props.errorCode?" (Error Code: "+this.props.errorCode+")":""},getFooterText:function(){return-41218===this.props.errorCode?"":t.p({className:"fail-panel-help-text"},t.span({className:"text-part"},a.translate(this.props.helpMessage)),t.a({onClick:this.openHelpLink,className:"link-part"},a.translate(this.props.helpLinkMessage)),t.span({className:"error-code-part"},this.getErrorCodeMessage()))},getConfirmLabel:function(){return-41218===this.props.errorCode?"PUBLISH_ERROR_SITE_DELETED_LINK":this.props.confirmLabel||"SAVE_PUBLISH_ERROR_BUTTON_OK"},onCancel:function(){this.props.biCancel&&this.getEditorAPI().bi.event(this.props.biCancel)},onConfirm:function(){this.props.biConfirm&&this.getEditorAPI().bi.event(this.props.biConfirm),-41218!==this.props.errorCode?e.invoke(this.props,"onConfirm"):window.location="https://wix.com/"},openHelpLink:function(){var e=this.getEditorAPI();this.props.biHelp&&this.getEditorAPI().bi.event(this.props.biHelp);var t={panel_name:this.props.panelName,origin:o.BI.HELP.ORIGIN.PANEL,learn_more:!0};e.panelManager.openHelpCenter(this.props.helpLink,null,t),e.panelManager.closePanelByName(this.props.panelName)},sendPanelLoadedBiEvent:function(){this.props.biEvent&&this.props.biParams&&this.getEditorAPI().bi.event(this.props.biEvent,this.props.biParams)},componentDidMount:function(){this.sendPanelLoadedBiEvent()},render:r})}),define("savePublish/panels/common/commonPanels",["savePublish/panels/common/failPanel"],function(e){"use strict";return{failPanel:e}}),define("savePublish/panels/save/chooseDomainPanel.rt",["react","lodash","panels","baseUI","santa-editor-symbols"],function(t,s,e,n,i){"use strict";return function(){return t.createElement(e.frames.focusPanelFrame,{className:"choose-domain-panel save-publish-panel",panelName:this.props.panelName,shouldHideHeader:!0,frameClassName:"save-publish-panel-frame",keyboardShortcuts:this.getKeyboardShortcuts()},t.createElement("header",{className:"save-publish-panel-header"},t.createElement("button",{className:"close",onClick:this.cancel},t.createElement(i.symbol,{name:"headerCloseButton"})),t.createElement("span",{className:"title"},this.getTitle()),t.createElement("span",{className:"subtitle"},this.getSubtitle())),function(){var e=this.getOptions()[this.DomainStates.FREE];return t.createElement("label",{className:s({"domain-option":!0,checked:this.state.domainChoice===this.DomainStates.FREE}).transform(function(e,t,s){t&&e.push(s)},[]).join(" ")},t.createElement("span",{className:"domain-option-label"},e.label),t.createElement("input",{className:"domain-option-radio-button",type:"radio",name:"domain-options",value:e.value,checked:this.state.domainChoice===e.value,onChange:function(e){this.handleDomainOptionSelected(e.value)}.bind(this,e)}),t.createElement("span",{}),t.createElement("div",{className:"domain-input"},t.createElement(n.domainInput,{value:e.domain,onChange:this.handleDomainChanged,prefix:e.prefix,isEditable:e.isEditable,domainValidator:e.domainValidator,biHandler:this.domainInputBiReporter})))}.apply(this,[]),function(){var e=this.getOptions()[this.DomainStates.BUY];return t.createElement("label",{className:s({"domain-option":!0,checked:this.state.domainChoice===this.DomainStates.BUY}).transform(function(e,t,s){t&&e.push(s)},[]).join(" ")},t.createElement("span",{className:"domain-option-label"},e.label),t.createElement("input",{className:"domain-option-radio-button",type:"radio",name:"domain-options",value:e.value,checked:this.state.domainChoice===e.value,onChange:function(e){this.handleDomainOptionSelected(e.value)}.bind(this,e)}),t.createElement("span",{}),t.createElement("span",{className:"connect-domain-example"},e.domain))}.apply(this,[]),t.createElement(n.button,{className:"choose-domain-action-button",shouldTranslate:!1,label:this.getActionButtonLabel(),onClick:this.handleAction,disabled:this.state.isActionDisabled}))}}),define("savePublish/panels/save/chooseDomainPanel",["create-react-class","prop-types","lodash","core","util","coreBi","constants","experiment","savePublish/panels/save/chooseDomainPanel.rt"],function(e,t,n,s,i,a,o,r,l){"use strict";return e({displayName:"chooseDomainPanel",mixins:[s.mixins.editorAPIMixin],propTypes:{defaultSiteName:t.string.isRequired,freeDomainPrefix:t.string.isRequired,freeDomainHandler:t.func.isRequired,connectDomainHandler:t.func.isRequired,overrideTitle:t.string,overrideSubtitle:t.string,panelName:t.string,isDomainConnected:t.bool,isSitePublished:t.bool},DomainStates:{FREE:"free",BUY:"buy"},getInitialState:function(){var e=this.getEditorAPI().siteName.validate(this.props.defaultSiteName);return{domainChoice:this.DomainStates.FREE,siteName:this.props.defaultSiteName,sanitizedSiteName:this.props.defaultSiteName,isActionDisabled:!e.success}},getTitle:function(){return i.translate(this.props.overrideTitle||"SAVE_CHOOSE_DOMAIN_TITLE_TITLE")},getSubtitle:function(){return i.translate(this.props.overrideSubtitle||"SAVE_CHOOSE_DOMAIN_TITLE_SUBTITLE")},getOptions:function(){var e={};return e[this.DomainStates.FREE]={value:"free",label:i.translate("SAVE_CHOOSE_DOMAIN_BODY_RADIO_BUTTON_1"),prefix:this.props.freeDomainPrefix,domain:this.state.siteName,isEditable:this.state.domainChoice===this.DomainStates.FREE,domainValidator:this.getEditorAPI().siteName.validate},e[this.DomainStates.BUY]={value:"buy",label:i.translate("SAVE_CHOOSE_DOMAIN_BODY_RADIO_BUTTON_2_LINE1"),domain:i.translate("SAVE_CHOOSE_DOMAIN_BODY_RADIO_BUTTON_2_LINE2"),isEditable:!1},e},getNextDomainOptionValue:function(){return this.state.domainChoice===this.DomainStates.FREE?this.DomainStates.BUY:this.DomainStates.FREE},getActionButtonLabel:function(){return i.translate("SAVE_CHOOSE_DOMAIN_BUTTON_SAVENCONTINUE")},handleDomainChanged:function(e){var t={};t.isActionDisabled=!e.isValid,t.siteName=e.value,t.sanitizedSiteName=e.sanitizedValue,this.setState(t)},handleDomainOptionSelected:function(e){if(!n.isEqual(this.state.domainChoice,e)){var t={domainChoice:e};if(e===this.DomainStates.BUY)t.isActionDisabled=!1,t.siteName=this.props.defaultSiteName,t.sanitizedSiteName=this.props.defaultSiteName;else{var s=this.getEditorAPI().siteName.validate(this.props.defaultSiteName);t.isActionDisabled=!s.success}this.setState(t),this.reportDomainClickedBI(e)}},handleAction:function(){if(this.reportActionButtonClickedBI(this.state.domainChoice),this.state.isActionDisabled)throw new Error("Should not get to handleAction if continue button is disabled");this.state.domainChoice===this.DomainStates.FREE?(r.isOpen("se_siteNameAsTitle")&&i.browserUtil.setTabTitle(i.browserUtil.getEditorTitleBySiteName(this.state.siteName)),this.close(),this.props.freeDomainHandler(this.state.sanitizedSiteName)):this.state.domainChoice===this.DomainStates.BUY&&(this.close(),this.props.connectDomainHandler())},reportActionButtonClickedBI:function(e){var t=this.getEditorAPI(),s=e===this.DomainStates.BUY?"connect your own domain":"free WIX domain";t.bi.event(a.events.save.chooseDomainPanel.ACTION_BUTTON_CLICKED,{value_selected:s})},reportDomainClickedBI:function(e){var t=this.getEditorAPI(),s=e===this.DomainStates.BUY?"connect your own domain":"free WIX domain";t.bi.event(a.events.save.chooseDomainPanel.DOMAIN_OPTION_CLICKED,{selection:s})},getUserStatus:function(){var e="";return this.props.isSitePublished||(e+="not_"),e+="published_",this.props.isDomainConnected||(e+="not_"),e+="connected"},domainInputBiReporter:function(e){var t={user_status:"not_published_not_connected",panel_name:this.props.panelName,save_or_publish:"save",is_first_save_or_publish:1};this.getEditorAPI().bi.event(a.events.domainInput[e],t)},cancel:function(){this.props.origin===o.CONNECT_DOMAIN.FLOWS.PUBLISH&&i.fedopsLogger.interactionEnded(i.fedopsLogger.INTERACTIONS.USER_PUBLISH_SITE),this.close()},close:function(){this.getEditorAPI().panelManager.closePanelByName(this.props.panelName)},getKeyboardShortcuts:function(){var t=this;return{enter:function(){t.state.isActionDisabled||t.handleAction()},esc:function(){t.cancel()},tab:function(e){t.handleDomainOptionSelected(t.getNextDomainOptionValue()),e.preventDefault()}}},render:l})}),define("savePublish/panels/save/siteWasSavedPanel.rt",["react","lodash","panels","baseUI","baseUILib","util","santa-editor-symbols"],function(i,a,e,o,r,l,t){"use strict";return function(){return i.createElement(e.frames.focusPanelFrame,{className:this.getPanelClass(),panelName:this.props.panelName,shouldHideHeader:!0,frameClassName:"save-publish-panel-frame",keyboardShortcuts:this.getKeyboardShortcuts()},i.createElement("header",{className:"save-publish-panel-header"},i.createElement("button",{className:"close",onClick:this.close},i.createElement(t.symbol,{name:"headerCloseButton"})),i.createElement("span",{className:"title"},this.getPanelTitle()),i.createElement("span",{className:"subtitle"},this.getPanelSubtitle())),function(){var e,t,s,n=this.getInnerPanel();return i.createElement("div",{className:"wrapper"},i.createElement("div",{className:"domain-input"},i.createElement(o.domainInputWithEditButtons,this.getDomainInputProps())),this.shouldDisplayInnerPanel()?i.createElement(n,(e={key:"innerPanel",className:"inner-panel "+this.getInnerPanelClass()},t=this.getInnerPanelProps(),s=a.assign({},e,t),e.hasOwnProperty("style")&&(s.style=a.defaults(s.style,e.style)),e.hasOwnProperty("className")&&t.hasOwnProperty("className")&&(s.className=t.className+" "+e.className),s)):null,i.createElement("div",{className:"site-saved-footer"},this.props.isFirstSave?null:i.createElement(r.Checkbox,{key:"dontShowAgainCheckbox",className:"dont-show-again",label:"SAVE_PUBLISH_DO_NOT_SHOW_AGAIN_LABEL",valueLink:{value:this.state.doNotShowAgain,requestChange:this.handleDontShowAgainClicked},labelAfterSymbol:!0}),this.props.isSitePremium&&!this.props.isDomainConnected&&this.props.isFirstSave?i.createElement("span",{key:"needHelpConnectingDomain",className:"help-connecting-domain"},l.translate("SAVE_SITE_SAVED_NEED_HELP_LABEL")+" ",i.createElement("a",{target:"_blank",href:l.translate("SAVE_SITE_SAVED_NEED_HELP_URL"),onClick:this.handleNeedHelpConnectingDomainClicked},l.translate("SAVE_SITE_SAVED_NEED_HELP_LINK"))):null,i.createElement("div",{className:"footer-buttons"},this.props.isSitePublished?i.createElement(o.button,{onClick:this.continueToPublish,key:"publishButton",className:"publish-button btn-confirm-secondary",label:"SAVE_SITE_SAVED_WHATS_NEXT_PUBLISH_LINK",disabled:this.state.isContinueDisabled}):null,i.createElement(o.button,{className:"continue-button btn-confirm-primary",label:"SAVE_SITE_SAVED_BUTTON_OK",onClick:this.continueEditing,disabled:this.state.isContinueDisabled}))))}.apply(this,[]))}}),define("savePublish/panels/content/generalContent.rt",["react","lodash","baseUILib","baseUI"],function(e,t,s,n){"use strict";return function(){return e.createElement("div",{className:this.getClassName()},e.createElement("div",{className:"main-title-wrapper"},e.createElement(s.Divider,{long:!0}),e.createElement("div",{className:"main-title"},this.translateIfNeeded(this.props.mainTitle)),e.createElement(s.Divider,{long:!0})),e.createElement("div",{className:"middle-spacer"}),e.createElement("div",{className:"bottom-section"},e.createElement("div",{className:"left-side"},this.props.symbolName?e.createElement(n.symbol,{name:this.props.symbolName,key:"symbol"}):null,this.props.imageSrc?e.createElement("img",{key:"image",src:this.props.imageSrc,style:this.props.imageStyle||{}}):null),e.createElement("div",{className:"right-side"},e.createElement("div",{className:"title"},this.translateIfNeeded(this.props.title)),this.props.subtitle?e.createElement("div",{key:"subtitle",className:"subtitle",dangerouslySetInnerHTML:{__html:this.translateIfNeeded(this.props.subtitle)}}):null,e.createElement("a",{className:"general-content-action",onClick:this.props.actionCallback},this.translateIfNeeded(this.props.actionLabel)))))}}),define("savePublish/panels/content/generalContent",["create-react-class","prop-types","util","savePublish/panels/content/generalContent.rt"],function(e,t,s,n){"use strict";return e({displayName:"generalContent",mixins:[s.translationMixin],propTypes:{symbolName:t.string,imageSrc:t.string,imageStyle:t.object,mainTitle:t.string.isRequired,title:t.string.isRequired,subtitle:t.string,actionCallback:t.func.isRequired,actionLabel:t.string.isRequired,className:t.string},getClassName:function(){return"general-content"+(this.props.className?" "+this.props.className:"")},render:n})}),define("savePublish/panels/content/connectDomain.rt",["react","lodash","savePublish/panels/content/generalContent"],function(n,i,a){"use strict";return function(){return n.createElement(a,(e={className:"connect-domain-content "+this.props.className},t=this.getGeneralContentProps(),s=i.assign({},e,t),e.hasOwnProperty("style")&&(s.style=i.defaults(s.style,e.style)),e.hasOwnProperty("className")&&t.hasOwnProperty("className")&&(s.className=t.className+" "+e.className),s));var e,t,s}}),define("savePublish/panels/content/connectDomain",["lodash","core","create-react-class","prop-types","util","savePublish/panels/content/connectDomain.rt","constants","experiment"],function(a,e,t,s,o,n,i,r){"use strict";var l=r.isOpen("spanishUpgradeText")?"UPGRADE_NOW_FOR_SPAIN_ONLY":"SAVE_PUBLISH_WHATS_NEXT_UPGRADE_LINK";return t({displayName:"connectDomain",mixins:[e.mixins.editorAPIMixin],propTypes:{className:s.string,closePanel:s.func.isRequired,sitePublishedDomain:s.string,currentDomain:s.string,isDomainConnected:s.bool,isFirstPublish:s.bool,isSitePremium:s.bool,isFirstSave:s.bool,actionCallback:s.func,flowId:s.oneOf(a.values(i.CONNECT_DOMAIN.FLOWS)).isRequired},getGeneralContentProps:function(){var e,t,s=this.getEditorAPI(),n={className:"",symbolName:"connectDomain",mainTitle:o.translate("SAVE_SITE_SAVED_WHATS_NEXT_LABEL"),title:o.translate("SAVE_PUBLISH_WHATS_NEXT_CONNECT_LINE1"),actionLabel:o.translate(this.props.isSitePremium?"SAVE_PUBLISH_WHATS_NEXT_CONNECT_LINK":l),shouldTranslate:!1,actionCallback:this.panelAction,subtitle:o.translate("SAVE_PUBLISH_WHATS_NEXT_CONNECT_LINE2")};if(s.campaigns.personalSale.isActiveCampaign()&&!this.props.isSitePremium){var i=s.campaigns.personalSale.getDiscountValue();a.assign(n,(e=i,t=a.template(o.translate("SAVE_PUBLISH_WHATS_NEXT_PERSONAL_SALE_TEXT_DYNAMIC")),{imageSrc:r.isOpen("se_personalSale")?o.media.getMediaUrl("savePublish/panels/content/connectDomain_"+e+".png"):void 0,symbolName:r.isOpen("se_personalSale")?void 0:"connectDomain_50",className:"personal-sale-campaign",subtitle:t({discount:a.toString(e)})}))}return n},panelAction:function(){this.props.actionCallback&&this.props.actionCallback(),this.props.closePanel(),this.isSiteBeingConnectedToDomain()?this.openConnectDomainInProgressPanel():!this.props.isDomainConnected&&this.props.isSitePremium?this.getEditorAPI().account.openConnectDomain(this.props.flowId):this.getEditorAPI().account.upgrade(this.getUpgradeReferralCode())},getUpgradeReferralCode:function(){var e="edhtml_";switch(this.props.flowId){case i.CONNECT_DOMAIN.FLOWS.PUBLISH:e+="PUBLISH_FLOW_"+(this.props.isFirstPublish?"FIRST_PUBLISH":"SECOND_PUBLISH");break;case i.CONNECT_DOMAIN.FLOWS.SAVE:e+="SAVE_FLOW_SECOND_SAVE_AND_PUBLISHED";break;default:e=null}return e},isSiteBeingConnectedToDomain:function(){return this.isUnconnectedDomainPremium()&&!a.isEmpty(this.props.sitePublishedDomain)&&!a.includes(this.props.sitePublishedDomain,"wix.com")},isUnconnectedDomainPremium:function(){return!this.props.isDomainConnected&&this.props.isSitePremium},openConnectDomainInProgressPanel:function(){this.getEditorAPI().panelManager.openPanel("savePublish.panels.connectDomainInProgress",{connectedDomainURL:this.props.sitePublishedDomain,currentPublicURL:this.props.currentDomain},!0)},render:n})}),define("savePublish/panels/content/publishContent.rt",["react","lodash","savePublish/panels/content/generalContent"],function(e,t,s){"use strict";return function(){return e.createElement(s,t.assign({},{className:this.getClassName()},this.getGeneralContentProps()))}}),define("savePublish/panels/content/publishContent",["create-react-class","prop-types","core","savePublish/panels/content/publishContent.rt"],function(e,t,s,n){"use strict";return e({displayName:"publishContent",mixins:[s.mixins.editorAPIMixin],propTypes:{closePanel:t.func.isRequired,publishMethod:t.func.isRequired,className:t.string,actionCallback:t.func},getClassName:function(){return"publish-site-content"+(this.props.className?" "+this.props.className:"")},getGeneralContentProps:function(){return{symbolName:"publishSite",mainTitle:"SAVE_SITE_SAVED_WHATS_NEXT_LABEL",title:"SAVE_SITE_SAVED_WHATS_NEXT_PUBLISH_LINE",actionLabel:"SAVE_SITE_SAVED_WHATS_NEXT_PUBLISH_LINK",actionCallback:this.publishSite}},publishSite:function(){this.props.closePanel(),this.props.publishMethod(),this.props.actionCallback&&this.props.actionCallback()},render:n})}),define("savePublish/panels/save/siteWasSavedPanel",["react-addons-linked-state-mixin","create-react-class","prop-types","lodash","core","coreBi","util","stateManagement","savePublish/constants/constants","savePublish/constants/savePublishErrorPanelData","savePublish/panels/save/siteWasSavedPanel.rt","savePublish/panels/content/connectDomain","constants","savePublish/panels/content/publishContent","experiment"],function(e,t,s,a,n,i,o,r,l,c,u,p,d,h,m){"use strict";var S="PUBLISH",_="CONNECT_DOMAIN";function E(e){var t=e.lastIndexOf("/");return{prefix:e.slice(0,t+1),siteName:e.slice(t+1)}}return t({displayName:"siteWasSavedPanel",mixins:[e,n.mixins.editorAPIMixin],propTypes:{domain:s.string.isRequired,isSitePremium:s.bool,isFirstSave:s.bool,isDomainConnected:s.bool,isSitePublished:s.bool,isMockSave:s.bool,overrideTitle:s.string,overrideSubtitle:s.string,panelName:s.string,callback:s.func},getInitialState:function(){var e={isContinueDisabled:!1,doNotShowAgain:null,domain:this.props.domain};return this.props.isFirstSave||(e.doNotShowAgain=!!r.editorPlugins.userPreferences.selectors.getSessionUserPreferences(d.USER_PREFS.SAVE.SITE_SAVED_DONT_SHOW_AGAIN)(this.getEditorAPI().store.getState())),e},getPanelTitle:function(){return o.translate(this.props.overrideTitle||"SAVE_SITE_SAVED_TITLE_TITLE")},getPanelSubtitle:function(){return o.translate(this.props.overrideSubtitle||"SAVE_SITE_SAVED_TITLE_SUBTITLE")},getDomainInputProps:function(){var e=void 0,t=this.state.domain;if(!this.props.isDomainConnected){var s=E(t);e={prefix:s.prefix,value:s.siteName,isEditable:!0,domainValidator:this.getEditorAPI().siteName.validate,domainHandler:this.props.isMockSave?null:this.renameSiteAndProcessResult,onChange:this.handleDomainEditingStatusChanged}}else e={value:t,isEditable:!1};return e.biHandler=this.domainInputBiReporter,e},getInnerPanelType:function(){return this.props.isSitePublished?this.props.isDomainConnected?void 0:_:S},getInnerPanel:function(){switch(this.getInnerPanelType()){case S:return h;case _:return p}},getPanelClass:function(){var e="site-was-saved-panel",t=this.getInnerPanelClass();return e+=t?" contains-"+t:"",this.props.isSitePremium&&this.props.isSitePublished&&this.props.isDomainConnected&&(e+=" narrow-domain-input"),e+" save-publish-panel"},getInnerPanelClass:function(){switch(this.getInnerPanelType()){case S:return"publish-inner-panel";case _:return"connect-domain-inner-panel"}},getInnerPanelProps:function(){var e={sitePublishedDomain:this.props.domain,isDomainConnected:this.props.isDomainConnected,isFirstPublish:!this.props.isSitePublished,isSitePremium:this.props.isSitePremium,isFirstSave:this.props.isFirstSave,flowId:d.CONNECT_DOMAIN.FLOWS.SAVE,closePanel:this.close},t=this.getInnerPanelType(),s=this.getEditorAPI();switch(t){case S:e.publishMethod=this.props.isMockSave?s.publishManager.configureMockPostPublish:s.publishManager.publish,this.props.isMockSave||(e.actionCallback=function(){this.reportPublishClickedBI(),this.getEditorAPI().bi.event(i.events.publish.PUBLISH_CLICK,{origin:"saveSuccessPanel"})}.bind(this));break;case _:this.props.isMockSave||(e.actionCallback=this.reportConnectDomainClickedBI)}return e},shouldDisplayInnerPanel:function(){return!this.props.isSitePublished||!this.props.isDomainConnected},continueToPublish:function(){o.fedopsLogger.interactionStarted(o.fedopsLogger.INTERACTIONS.USER_PUBLISH_SITE),o.fedopsLogger.interactionStarted(o.fedopsLogger.INTERACTIONS.DEALER_IN_POST_PUBLISH),this.props.isMockSave||(this.getEditorAPI().bi.event(i.events.publish.PUBLISH_CLICK,{origin:"saveSuccessPanel"}),this.reportBIWithUserStatus(i.events.save.siteWasSavedPanel.SECOND_SAVE_PUBLISH_NOW_BUTTON_CLICKED)),this.close(),this.getEditorAPI().publishManager.publish()},continueEditing:function(){if(this.props.isMockSave||(this.props.isFirstSave?this.getEditorAPI().bi.event(i.events.save.siteWasSavedPanel.FIRST_SAVE_ACTION_BUTTON_CLICKED,{}):this.reportBIWithUserStatus(i.events.save.siteWasSavedPanel.SECOND_SAVE_ACTION_BUTTON_CLICKED)),this.state.isContinueDisabled)throw new Error("Should not get to continueEditing if continue button is disabled");this.state.doNotShowAgain&&(m.isOpen("se_postSavePublishPreference")?this.getEditorAPI().store.dispatch(r.editorPlugins.userPreferences.actions.setSiteUserPreferences(d.USER_PREFS.SAVE.SITE_SAVED_DONT_SHOW_AGAIN,Date.now())):this.getEditorAPI().store.dispatch(r.editorPlugins.userPreferences.actions.setSessionUserPreferences(d.USER_PREFS.SAVE.SITE_SAVED_DONT_SHOW_AGAIN,this.state.doNotShowAgain))),this.close()},reportBIWithUserStatus:function(e){var t={user_status:this.getUserStatus()};this.getEditorAPI().bi.event(e,t)},getUserStatus:function(){var e="";return this.props.isSitePublished||(e+="not_"),e+="published_",this.props.isDomainConnected||(e+="not_"),e+="connected"},renameSiteAndProcessResult:function(e,t,n){var i=this.getEditorAPI();i.siteName.rename(e,function(){t()},function(e){var t=e&&e.errorCode;if(t===l.RENAME.ERRORS.SITE_NAME_TAKEN)n("SAVE_SITE_NAME_ALREADY_EXISTS");else{n();var s=a.chain(c.NAME_SITE_AGAIN_PANEL_DATA).clone().defaults(c.SAVE_ERROR_DEFAULT_PANEL_DATA).assign({errorCode:t}).value();i.panelManager.openPanel("savePublish.panels.common.failPanel",s,!0)}})},handleDomainEditingStatusChanged:function(e){var t={};if(e){var s=E(this.props.domain).prefix;t.isContinueDisabled=!1,t.domain=s+e}else t.isContinueDisabled=!0;this.setState(t)},handleNeedHelpConnectingDomainClicked:function(){this.getEditorAPI().bi.event(i.events.save.siteWasSavedPanel.HELP_CONNECTING_DOMAIN_CLICKED,{})},handleDontShowAgainClicked:function(e){this.setState({doNotShowAgain:e}),this.getEditorAPI().bi.event(i.events.save.siteWasSavedPanel.SECOND_SAVE_DONT_SHOW_AGAIN_CLICKED,{toggle:e,user_status:this.getUserStatus()})},reportPublishClickedBI:function(){this.getEditorAPI().bi.event(i.events.save.siteWasSavedPanel.PUBLISH_NOW_CLICKED,{user_status:this.getUserStatus(),is_first_save:this.props.isFirstSave?1:0})},reportConnectDomainClickedBI:function(){this.getEditorAPI().bi.event(i.events.save.siteWasSavedPanel.SECOND_SAVE_CONNECT_DOMAIN_CLICKED,{user_status:this.getUserStatus()})},domainInputBiReporter:function(e){if(!this.props.isMockSave){var t={user_status:this.getUserStatus(),panel_name:this.props.panelName,save_or_publish:"save",is_first_save_or_publish:this.props.isFirstSave?1:0};this.getEditorAPI().bi.event(i.events.domainInput[e],t)}},componentWillUnmount:function(){this.props.callback&&this.props.callback()},close:function(){this.getEditorAPI().panelManager.closePanelByName(this.props.panelName)},getKeyboardShortcuts:function(){var e=this;return{enter:function(){e.state.isContinueDisabled||e.continueEditing()},esc:function(){e.close()}}},render:u})}),define("savePublish/panels/save/concurrentSavePanel.rt",["react","lodash","panels","baseUI","santa-editor-symbols","util"],function(e,t,s,n,i,a){"use strict";return function(){return e.createElement(s.frames.confirmationPanelFrame,{panelName:this.props.panelName,className:"concurrent-save-panel save-publish-panel",panelTitle:a.translate(this.getTitle()),keyboardShortcuts:this.getKeyboardShortcuts(),confirmLabel:this.getConfirmLabel(),cancelLabel:this.getCancelLabel(),onConfirm:this.overrideSave,onCancel:this.handleCancel,onClose:this.close},e.createElement("div",{className:"content-wrapper"},e.createElement("div",{className:"error-logo"},e.createElement(n.symbol,{name:"plaster"})),this.isAutosave()?null:e.createElement("div",{key:"withoutAutosave",className:"description-wrapper"},e.createElement("span",{className:"description-line",dangerouslySetInnerHTML:{__html:a.translate("SAVE_PUBLISH_MULTIPLE_TABS_ERRROR_TOOLTIP_LINE1")}}),e.createElement("span",{className:"description-line",dangerouslySetInnerHTML:{__html:a.translate("SAVE_PUBLISH_MULTIPLE_TABS_ERRROR_TOOLTIP_LINE2")}})),this.isAutosave()?e.createElement("div",{key:"withAutosave",className:"description-wrapper"},e.createElement("div",{className:"description-line initialPadding",dangerouslySetInnerHTML:{__html:a.translate(this.getBodyText()[0])}}),e.createElement("div",{className:"description-line initialPadding",dangerouslySetInnerHTML:{__html:a.translate(this.getBodyText()[1])}}),e.createElement("div",{className:"description-line initialPadding",dangerouslySetInnerHTML:{__html:a.translate(this.getBodyText()[2])}})):null))}}),define("savePublish/panels/save/concurrentSavePanel",["create-react-class","prop-types","core","savePublish/panels/save/concurrentSavePanel.rt","coreBi","coreUtilsLib"],function(e,t,s,n,i,a){"use strict";return e({displayName:"concurrentSavePanel",mixins:[s.mixins.editorAPIMixin],propTypes:{overrideSaveMethod:t.func.isRequired,onCancel:t.func,panelName:t.string,origin:t.string},isAutosave:function(){return"autosave"===this.props.origin},getTitle:function(){return this.isAutosave()?"AUTOSAVE_ERROR_CONCURRENT_EDITING_TITLE":"SAVE_PUBLISH_MULTIPLE_TABS_ERRROR_TOOLTIP_TITLE"},getBodyText:function(){return this.isAutosave()?["AUTOSAVE_ERROR_CONCURRENT_EDITING_DESCRIPTION_HEADER","AUTOSAVE_ERROR_CONCURRENT_EDITING_DESCRIPTION_OPTION1","AUTOSAVE_ERROR_CONCURRENT_EDITING_DESCRIPTION_OPTION2"]:["SAVE_PUBLISH_MULTIPLE_TABS_ERRROR_TOOLTIP_LINE1","SAVE_PUBLISH_MULTIPLE_TABS_ERRROR_TOOLTIP_LINE2"]},getConfirmLabel:function(){return this.isAutosave()?"AUTOSAVE_ERROR_CONCURRENT_EDITING_BUTTON_LABEL":"SAVE_ERROR_CONCURRENT_EDITING_SAVE_BUTTON"},getCancelLabel:function(){return this.isAutosave()?"AUTOSAVE_ERROR_CONCURRENT_EDITING_LINK_LABEL":"SAVE_ERROR_CONCURRENT_EDITING_DONT_SAVE_BUTTON"},overrideSave:function(){this.props.overrideSaveMethod?(this.props.overrideSaveMethod(this.getEditorAPI),this.sendBI("save")):a.log.info("Mock Overriding Save"),this.close()},handleCancel:function(){this.props.overrideSaveMethod&&this.sendBI(this.isAutosave()?"update":"don't save"),this.close(),this.props.onCancel&&this.props.onCancel()},close:function(){this.getEditorAPI().panelManager.closePanelByName(this.props.panelName)},sendBI:function(e){var t=i.events.save.saveFailed,s=this.isAutosave()?t.CONCURRENT_AUTOSAVE:t.CONCURRENT_SAVE;this.getEditorAPI().bi.event(s,{selection:e})},getKeyboardShortcuts:function(){var e=this;return{esc:function(){e.close()}}},render:n})}),define("savePublish/panels/save/saveConfigurationPanel.rt",["react","lodash","panels","baseUI","baseUILib"],function(n,i,a,o,r){"use strict";return function(){return n.createElement(a.frames.emptyPanelFrame,(e={ref:"frame",className:"save-configuration-panel"},t=this.getFrameProps(),s=i.assign({},e,t),e.hasOwnProperty("style")&&(s.style=i.defaults(s.style,e.style)),e.hasOwnProperty("className")&&t.hasOwnProperty("className")&&(s.className=t.className+" "+e.className),s),n.createElement("a",{className:"close-button",onClick:this.close},"x"),n.createElement("h2",{style:{textAlign:"center"}},"Save Testing Configuration"),n.createElement(r.Checkbox,{className:"checkbox-field",label:"First save",valueLink:this.linkState("isFirstSave"),shouldTranslate:!1,labelAfterSymbol:!0}),n.createElement(r.Checkbox,{className:"checkbox-field",label:"Save succeeds",valueLink:this.linkState("shouldSaveSucceed"),shouldTranslate:!1,labelAfterSymbol:!0}),n.createElement("p",{},n.createElement("br",{}),"Premium Interaction:"),n.createElement(r.Checkbox,{className:"checkbox-field",label:"Site is/upgraded-to premium",value:this.state.isSitePremium,onChange:this.premiumToggled,shouldTranslate:!1,labelAfterSymbol:!0}),n.createElement(r.Checkbox,{className:"checkbox-field",label:"Domain is/will-be connected",value:this.state.isDomainConnected,onChange:this.domainConnectedToggled,shouldTranslate:!1,labelAfterSymbol:!0}),n.createElement(o.textInput,{className:"domain-text-field",shouldTranslate:!1,label:"Custom Domain",valueLink:this.linkState("domain"),disabled:!this.state.isDomainConnected}),n.createElement(r.Checkbox,{className:"checkbox-field"+(this.state.isFirstSave?" disabled":""),label:"Site is published",valueLink:this.linkState("isSitePublished"),disabled:this.state.isFirstSave,shouldTranslate:!1,labelAfterSymbol:!0}),n.createElement("button",{className:"concurrent-save-button",shouldTranslate:!1,onClick:this.openConcurrentSave},"Concurrent Save"),n.createElement("button",{className:"save-reminder-button",shouldTranslate:!1,onClick:this.openSaveReminder},"Save Reminder"),n.createElement("div",{className:"save-configuration-footer"},n.createElement(o.button,{className:"confirm-button",shouldTranslate:!1,label:"Start Save",onClick:this.onConfirm})));var e,t,s}}),define("savePublish/panels/save/saveConfigurationPanel",["react-addons-linked-state-mixin","create-react-class","prop-types","core","savePublish/panels/save/saveConfigurationPanel.rt","coreUtilsLib"],function(e,t,s,n,i,a){"use strict";return t({displayName:"SaveConfigurationPanel",mixins:[e,n.mixins.editorAPIMixin],propTypes:{onConfirm:s.func.isRequired,panelName:s.string},getInitialState:function(){return{isSitePremium:!1,isFirstSave:!0,isDomainConnected:!1,domain:"http://www.my-domain.com",isSitePublished:!1,shouldSaveSucceed:!0}},getFrameProps:function(){return{panelName:this.props.panelName}},openConcurrentSave:function(){this.getEditorAPI().panelManager.openPanel("savePublish.panels.save.concurrentSavePanel",{overrideSaveMethod:function(){a.log.info("Override Save")}},!0)},openSaveReminder:function(){this.getEditorAPI().panelManager.openPanel("savePublish.panels.save.saveReminderPanel",{saveMethod:this.onConfirm},!0)},componentWillUpdate:function(e,t){t.isFirstSave&&t.isSitePublished&&this.setState({isSitePublished:!1,isFirstSave:!0})},premiumToggled:function(){var e=!this.state.isSitePremium;this.setState({isSitePremium:e,isDomainConnected:!!e&&this.state.isDomainConnected})},domainConnectedToggled:function(){var e=!this.state.isDomainConnected;this.setState({isDomainConnected:e,isSitePremium:e||this.state.isSitePremium})},onConfirm:function(){this.props.onConfirm({isSitePremium:this.state.isSitePremium,isFirstSave:this.state.isFirstSave,isDomainConnected:this.state.isDomainConnected,domain:this.state.domain,isSitePublished:this.state.isSitePublished,shouldSaveSucceed:this.state.shouldSaveSucceed})},close:function(){this.getEditorAPI().panelManager.closePanelByName(this.props.panelName)},render:i})}),define("savePublish/panels/save/saveReminderPanel.rt",["react","lodash","util","baseUI","panels","experiment"],function(e,t,s,n,i,a){"use strict";return function(){return a.isOpen("disableSaveReminder")?null:e.createElement(i.frames.messagePanelFrame,{ref:"frame",key:"saveReminder",panelName:this.props.panelName,className:"save-reminder-panel save-publish-panel",panelTitle:s.translate("SAVE_REMINDER_MSG_TITLE"),confirmLabel:"SAVE_REMINDER_MSG_BUTTON",onConfirm:this.handleSave,keyboardShortcuts:this.getKeyboardShortcuts()},e.createElement("div",{className:"content-wrapper"},e.createElement("div",{className:"icon"},e.createElement(n.symbol,{name:"saveYourWork"})),e.createElement("div",{className:"message"},s.translate("SAVE_REMINDER_MSG_BODY"))))}}),define("savePublish/panels/save/saveReminderPanel",["create-react-class","prop-types","lodash","core","coreBi","savePublish/panels/save/saveReminderPanel.rt"],function(e,t,s,n,i,a){"use strict";return e({displayName:"saveReminderPanel",mixins:[n.mixins.editorAPIMixin],propTypes:{saveMethod:t.func.isRequired,panelName:t.string},componentWillMount:function(){this.getEditorAPI().bi.event(i.events.save.saveReminder.REMINDER_DISPLAYED,{origin:"pop up message"})},handleSave:function(){this.getEditorAPI().bi.event(i.events.save.saveReminder.SAVE_CLICKED,{}),this.close(),this.props.saveMethod()},getKeyboardShortcuts:function(){var e=this;return{enter:function(){e.close(),e.handleSave()},esc:function(){e.close()}}},close:function(){this.getEditorAPI().panelManager.closePanelByName(this.props.panelName)},render:a})}),define("savePublish/panels/save/onBoardingMigrationConfirmationPanel.rt",["react","lodash","panels","baseUI"],function(e,t,s,n){"use strict";return function(){return e.createElement(s.frames.focusPanelFrame,{ref:"frame",key:"onBoardingMigrationConfirmationPanel",shouldHideHelp:!0,className:"save-on-boarding-site-confirm-panel",title:this.translateIfNeeded("ADI_EDITOR_MIGRATION_SAVEPOPUP_TITLE"),panelName:this.props.panelName},e.createElement("div",{className:"save-on-boarding-site-confirm-content"},e.createElement("div",{className:"image-container"},e.createElement(n.symbol,{name:"obMigrationBeforeSave"})),e.createElement("div",{className:"description-container"},e.createElement("span",{className:"description-text"},this.translateIfNeeded("ADI_EDITOR_MIGRATION_SAVEPOPUP_TEXT"))),e.createElement("div",{className:"footer-buttons"},e.createElement(n.button,{onClick:this.navigateToOnBoarding,className:"btn-confirm-secondary btn-md footer-button",label:"ADI_EDITOR_MIGRATION_SAVEPOPUP_BUTTON_ADI"}),e.createElement(n.button,{onClick:this.saveDocument,className:"btn-confirm-primary btn-md footer-button",label:"ADI_EDITOR_MIGRATION_SAVEPOPUP_BTN_SAVE"}))))}}),define("savePublish/panels/save/onBoardingMigrationConfirmationPanel",["create-react-class","prop-types","util","core","coreBi","savePublish/panels/save/onBoardingMigrationConfirmationPanel.rt"],function(e,t,s,n,i,a){"use strict";var o="Go Back to Wix ADI",r="Save Changes";function l(e,t){e.bi.event(i.events.ON_BOARDING_MIGRATION.PANEL_ACTION_CLICKED,{action:t})}return e({displayName:"onBoardingMigrationConfirmationPanel",propTypes:{panelName:t.string.isRequired,onConfirm:t.func.isRequired,onCancel:t.func},mixins:[s.translationMixin,n.mixins.editorAPIMixin],saveDocument:function(){l(this.getEditorAPI(),r),this.props.onConfirm(),this.close()},navigateToOnBoarding:function(){this.props.onCancel(),l(this.getEditorAPI(),o),window.location=s.editorModel.onboardingEditorUrl},close:function(){this.getEditorAPI().panelManager.closePanelByName(this.props.panelName)},render:a})}),define("savePublish/panels/save/saveYourSitePanel.rt",["react","lodash","util","baseUI","panels"],function(e,t,s,n,i){"use strict";return function(){return e.createElement(i.frames.messagePanelFrame,{ref:"frame",panelName:this.props.panelName,className:"save-your-site-panel",panelTitle:s.translate(this.props.title),confirmLabel:"TOPBAR_SETTINGS_BUTTON_SAVE",onConfirm:this.handleSave,keyboardShortcuts:this.keyboardShortcuts},e.createElement("div",{className:"content-wrapper"},e.createElement("div",{className:"logo"},e.createElement(n.symbol,{name:"saveYourWork"})),e.createElement("div",{className:"message"},s.translate(this.props.messageBody))))}}),define("savePublish/panels/save/saveYourSitePanel",["create-react-class","prop-types","lodash","core","savePublish/panels/save/saveYourSitePanel.rt"],function(e,t,s,n,i){"use strict";return e({displayName:"saveYourSitePanel",mixins:[n.mixins.editorAPIMixin],propTypes:{title:t.string.isRequired,panelName:t.string,messageBody:t.string.isRequired},getInitialState:function(){return this.keyboardShortcuts={enter:this.handleSave,esc:this.close},{}},handleSave:function(){this.close(),this.getEditorAPI().saveManager.save()},close:function(){this.getEditorAPI().panelManager.closePanelByName(this.props.panelName)},render:i})}),define("savePublish/panels/save/savePanels",["savePublish/panels/save/chooseDomainPanel","savePublish/panels/save/siteWasSavedPanel","savePublish/panels/save/concurrentSavePanel","savePublish/panels/save/saveConfigurationPanel","savePublish/panels/save/saveReminderPanel","savePublish/panels/save/onBoardingMigrationConfirmationPanel","savePublish/panels/save/saveYourSitePanel"],function(e,t,s,n,i,a,o){"use strict";return{chooseDomainPanel:e,siteWasSavedPanel:t,concurrentSavePanel:s,saveConfigurationPanel:n,saveReminderPanel:i,onBoardingMigrationConfirmationPanel:a,saveYourSitePanel:o}}),define("savePublish/panels/publish/config/publishConfigurationPanel.rt",["react","lodash","panels","baseUI","baseUILib"],function(e,t,s,n,i){"use strict";return function(){return e.createElement(s.frames.emptyPanelFrame,{className:"save-configuration-panel",panelName:this.props.panelName},e.createElement("a",{className:"close-button",onClick:this.close},"x"),e.createElement("h2",{style:{textAlign:"center"}},"Publish Testing Configuration"),e.createElement(i.Checkbox,{className:"checkbox-field",label:"Is Contributor to site",valueLink:this.linkState("isSiteContributor"),shouldTranslate:!1,labelAfterSymbol:!0}),e.createElement(i.Checkbox,{className:"checkbox-field",label:"Did Publish Succeed",valueLink:this.linkState("shouldPublishSucceed"),shouldTranslate:!1,labelAfterSymbol:!0}),e.createElement(i.Checkbox,{className:"checkbox-field",label:"Site is Premium",valueLink:this.linkState("isPremiumUser"),shouldTranslate:!1,labelAfterSymbol:!0}),e.createElement(i.Checkbox,{className:"checkbox-field",label:"First Publish",valueLink:this.linkState("isFirstPublish"),shouldTranslate:!1,labelAfterSymbol:!0}),e.createElement(i.Checkbox,{className:"checkbox-field",label:"Is Domain Connected",valueLink:this.linkState("isDomainConnected"),shouldTranslate:!1,labelAfterSymbol:!0}),e.createElement(n.textInput,{className:"domain-text-field",shouldTranslate:!1,label:"Site address (Domain Name)",valueLink:this.linkState("sitePremiumDomain")}),e.createElement(n.button,{className:"confirm-button",disabled:!this.state.isPremiumUser&&this.state.isDomainConnected&&this.state.shouldPublishSucceed,shouldTranslate:!1,label:"Start Publish",onClick:this.onConfirm}))}}),define("savePublish/panels/publish/config/publishConfigurationPanel",["react-addons-linked-state-mixin","create-react-class","prop-types","core","savePublish/panels/publish/config/publishConfigurationPanel.rt"],function(e,t,s,n,i){"use strict";return t({displayName:"publishConfigurationPanel",mixins:[e,n.mixins.editorAPIMixin],propTypes:{onConfirm:s.func.isRequired,panelName:s.string},getInitialState:function(){return{isSiteContributor:!1,isFirstPublish:!0,isDomainConnected:!1,isPremiumUser:!0,shouldPublishSucceed:!0,sitePremiumDomain:"http://www.published-site-domain.com"}},onConfirm:function(){this.props.onConfirm({isSiteContributor:this.state.isSiteContributor,isFirstPublish:this.state.isFirstPublish,isDomainConnected:this.state.isDomainConnected,sitePremiumDomain:this.state.sitePremiumDomain,isPremiumUser:this.state.isPremiumUser,shouldPublishSucceed:this.state.shouldPublishSucceed})},close:function(){this.getEditorAPI().panelManager.closePanelByName(this.props.panelName)},render:i})}),define("savePublish/panels/publish/content/postPublishPromotePanel.rt",["react","lodash","baseUILib","baseUI"],function(s,e,t,n){"use strict";return function(){return s.createElement("div",{className:"panel-shout-out"},s.createElement("div",{className:"promote-title-wrapper"},s.createElement(t.Divider,{long:!0}),s.createElement("div",{className:"promote-title"},this.getTitle()),s.createElement(t.Divider,{long:!0})),s.createElement.apply(this,["div",{className:"promotion-content"},e.map(this.getPanelContent(),function(e,t){return s.createElement("div",{className:"promote",key:e.key},e.symbol?s.createElement("div",{key:"promotionSymbol-"+e.key,className:"promote-symbol promote-symbol-"+e.key},s.createElement(n.symbol,{name:e.symbol})):null,e.img&&!e.symbol?s.createElement("div",{key:"promotionImg-"+e.key,className:"promote-image",style:{backgroundImage:"url("+e.img+")"}}):null,s.createElement("div",{className:"description"},e.description),s.createElement("a",{onClick:e.action},e.actionTitle))}.bind(this))]))}}),define("savePublish/panels/publish/content/shoutoutPanel",["lodash","create-react-class","prop-types","core","util","coreBi","savePublish/panels/publish/content/postPublishPromotePanel.rt"],function(e,t,s,n,i,a,o){"use strict";return t({displayName:"shoutoutPanel",mixins:[n.mixins.editorAPIMixin],propTypes:{isUserPremium:s.bool,languageCode:s.string,metaSiteId:s.string.isRequired,sitePublicUrl:s.string,siteNameSEO:s.string,siteDescriptionSEO:s.string,isFirstPublish:s.bool,userStatus:s.string},getTitle:function(){return i.translate("PUBLISH_CONGRATULATIONS_WHATS_NEXT_TITLE")},getPanelContent:function(){return[{key:"seo",symbol:"publishSeo",description:i.translate("PUBLISH_CONGRATULATIONS_WHATS_NEXT_SEO_TITLE"),actionTitle:i.translate("PUBLISH_CONGRATULATIONS_WHATS_NEXT_SEO_LINK"),action:this.openSeoWizard},{key:"twitter",symbol:"publishTwitter",description:i.translate("PUBLISH_CONGRATULATIONS_WHATS_NEXT_2_TITLE"),actionTitle:i.translate("PUBLISH_CONGRATULATIONS_WHATS_NEXT_2_LINK"),action:this.openTwitter},{key:"shoutout",symbol:"publishShoutout",description:i.translate("PUBLISH_CONGRATULATIONS_WHATS_NEXT_3_TITLE"),actionTitle:i.translate("PUBLISH_CONGRATULATIONS_WHATS_NEXT_3_LINK"),action:this.openShoutout}]},openFacebook:function(){this.sendSecondPublishBI(a.events.publish.Second_Publish_facebook_Share_click),n.utils.social.openFacebook(this.props.sitePublicUrl,this.props.languageCode,this.props.siteNameSEO,this.props.siteDescriptionSEO)},openSeoWizard:function(){this.sendSecondPublishBI(a.events.publish.Second_Publish_Seo_Wizard_click),this.getEditorAPI().account.openWixSEOWiz("EDITOR_POSTPUBLISH")},openTwitter:function(){this.sendSecondPublishBI(a.events.publish.Second_Publish_Twitter_share_click),n.utils.social.openTwitter(this.props.sitePublicUrl,this.props.isUserPremium)},openShoutout:function(){this.sendSecondPublishBI(a.events.publish.Second_Publish_ShoutOut_Share_click),n.utils.social.openShoutout(this.props.metaSiteId)},sendSecondPublishBI:function(e){!this.props.isFirstPublish&&this.props.userStatus&&this.getEditorAPI().bi.event(e,{user_status:this.props.userStatus})},render:o})}),define("savePublish/panels/publish/content/growBusinessPanel",["create-react-class","prop-types","core","util","experiment","coreBi","savePublish/panels/publish/content/postPublishPromotePanel.rt"],function(e,t,s,i,a,n,o){"use strict";return e({displayName:"growBusinessPanel",mixins:[s.mixins.editorAPIMixin],propTypes:{metaSiteId:t.string.isRequired,isFirstPublish:t.bool,userStatus:t.string},getTitle:function(){return i.translate("PUBLISH_CONGRATULATIONS_NEXT_PROMOTE_TITLE")},getPanelContent:function(){var e={key:"seo",symbol:"publishSeo",description:i.translate("PUBLISH_CONGRATULATIONS_WHATS_NEXT_SEO_TITLE"),actionTitle:i.translate("PUBLISH_CONGRATULATIONS_WHATS_NEXT_SEO_LINK"),action:this.openSeoWizard},t={key:"newsletter",symbol:"publishShoutout",description:i.translate("PUBLISH_CONGRATULATIONS_NEXT_PROMOTE_1_TITLE"),actionTitle:i.translate("PUBLISH_CONGRATULATIONS_NEXT_PROMOTE_1_LINK"),action:this.openShoutout},s={key:"mail",symbol:"promoteMail",description:i.translate("PUBLISH_CONGRATULATIONS_NEXT_PROMOTE_2_TITLE"),actionTitle:i.translate("PUBLISH_CONGRATULATIONS_NEXT_PROMOTE_2_LINK"),action:this.getYourOwnMailbox},n={key:"traffic",symbol:"promoteContact",description:i.translate("PUBLISH_CONGRATULATIONS_NEXT_PROMOTE_3_TITLE"),actionTitle:i.translate("PUBLISH_CONGRATULATIONS_NEXT_PROMOTE_3_LINK"),action:this.getTrafficApps};return a.isOpen("newPublishPanel")?[t,s,e]:[t,s,n]},openSeoWizard:function(){this.props.userStatus&&this.getEditorAPI().bi.event(n.events.publish.Second_Publish_Seo_Wizard_click,{user_status:this.props.userStatus}),this.getEditorAPI().account.openWixSEOWiz("EDITOR_POSTPUBLISH_PREMIUM")},openShoutout:function(){this.sendPublishBI(n.events.publish.First_Publish_Send_ShoutOut_link_click,n.events.publish.Second_Publish_ShoutOut_Share_click),s.utils.social.openShoutout(this.props.metaSiteId)},getYourOwnMailbox:function(){this.sendPublishBI(n.events.publish.First_Publish_get_own_Mailbox_link_click,n.events.publish.Second_Publish_get_own_Mailbox_click),window.open("https://premium.wix.com/wix/api/googleMailBoxConsole?referralAdditionalInfo=da_quick_actions")},getTrafficApps:function(){this.sendPublishBI(n.events.publish.First_Publish_Traffic_Apps_link_click,n.events.publish.Second_Publish_Traffic_Apps_click);var e=["//www.wix.com/my-account/sites/",this.props.metaSiteId,"/apps/all?referralInfo=premium_publish"].join("");window.open(e)},sendPublishBI:function(e,t){this.props.isFirstPublish&&this.props.userStatus?this.getEditorAPI().bi.event(e,{user_status:this.props.userStatus}):!this.props.isFirstPublish&&this.props.userStatus&&this.getEditorAPI().bi.event(t,{user_status:this.props.userStatus})},render:o})}),define("savePublish/panels/publish/publishSuccessPanel.rt",["react","lodash","panels","util","baseUI","baseUILib","santa-editor-symbols"],function(i,a,o,r,l,c,u){"use strict";return function(){return function(){var e,t,s,n=this.getInnerPanel();return i.createElement(o.frames.focusPanelFrame,(e={className:this.getFrameClass(),frameClassName:this.getPanelFrameClassName(),keyboardShortcuts:this.getShortcuts()},t=this.getFrameProps(),s=a.assign({},e,t),e.hasOwnProperty("style")&&(s.style=a.defaults(s.style,e.style)),e.hasOwnProperty("className")&&t.hasOwnProperty("className")&&(s.className=t.className+" "+e.className),s),i.createElement("header",{className:"save-publish-panel-header"},i.createElement("button",{className:"close",onClick:this.props.closePanel},i.createElement(u.symbol,{name:"headerCloseButton"})),i.createElement("span",{className:"title"},r.translate("PUBLISH_CONGRATULATIONS_TITLE_TITLE")),i.createElement("span",{className:"subtitle"},r.translate("PUBLISH_CONGRATULATIONS_TITLE_SUBTITLE"))),i.createElement("div",{className:"address-bar-wrapper"},i.createElement("span",{className:"address"},i.createElement(l.domainInput,{value:this.getSiteUrl(),isEditable:!1,biHandler:this.domainInputBiReporter})),i.createElement(l.button,{className:"view-site-button",label:"SAVE_PUBLISH_BUTTON_VIEW",onClick:this.viewYourSite})),null!==n?i.createElement("div",{key:"innerPanel",className:"publish-inner-panel"},n):null,i.createElement("div",{className:"publish-success-footer"},this.isDontShowAgainCheckboxVisible()&&null!==n?i.createElement(c.Checkbox,{key:"dontShowAgain",className:"dont-show-again",label:"SAVE_PUBLISH_DO_NOT_SHOW_AGAIN_LABEL",value:this.state.dontShowAgain,onChange:this.toggleDontShowAgain,labelAfterSymbol:!0}):null,i.createElement("div",{className:"footer-buttons"},this.isSecondaryButtonDisplayed()?i.createElement(l.button,{key:"secondaryFooterButton",className:"btn-confirm-secondary",label:this.getSecondaryButtonText(),onClick:this.handleSecondaryButtonClicked}):null,i.createElement(l.button,{className:"btn-confirm-primary",label:this.getPrimaryButtonText(),onClick:this.handlePrimaryButtonClicked}))))}.apply(this,[])}}),define("savePublish/panels/publish/publishSuccessPanel",["react-addons-linked-state-mixin","react","create-react-class","lodash","prop-types","core","util","stateManagement","savePublish/panels/publish/publishInnerPanelTypes","savePublish/panels/publish/content/shoutoutPanel","savePublish/panels/publish/content/growBusinessPanel","savePublish/panels/content/connectDomain","savePublish/panels/publish/publishSuccessPanel.rt","coreBi","constants","experiment"],function(e,n,t,i,s,a,o,r,l,c,u,p,d,h,m,S){"use strict";var _=r.editorPlugins.domain.selectors;return t({displayName:"publishSuccessPanel",mixins:[e,a.mixins.editorAPIMixin],propTypes:{isFakePanel:s.bool,contentPanelType:function(e,t,s){if(!e[t]||!i.some(l,e[t]))return new Error("Invalid prop `"+t+"` supplied to "+s+". Validation failed.")},configuration:s.object.isRequired,currentDomain:s.string.isRequired,setDontShowPanelValue:s.func.isRequired,sitePublicUrl:s.string.isRequired,closePanel:s.func.isRequired,panelName:s.string,dealerViewer:s.func},componentWillUnmount:function(){this.renderTimeout&&o.dealerUtils.clearDealerRenderSuccessTimeout(this.renderTimeout),S.isOpen("se_fixPublishFlow")&&i.forEach(this.getEditorAPI().sitePublishedCallbacks,function(e){e()})},componentDidMount:function(){this.props.dealerViewer?this.renderTimeout=o.dealerUtils.createDealerRenderSuccessTimeout(this.onDealerError):this.sendPanelDisplayedBI(!1)},getInitialState:function(){return{dealerViewerProps:this.getDealerViewerProps(),dontShowAgain:!1,hasDealerFailed:!1,hasDealerSucceeded:!1}},getDealerViewerProps:function(){return i.assign({},o.dealerUtils.getDealerViewerBaseProps(),{metaSiteId:this.getEditorAPI().dsRead.generalInfo.getMetaSiteId(),bannerPosition:o.dealerUtils.bannerPositions.POST_PUBLISH,key:"dealerViewerPublish",onDisplay:this.onDealerDisplay,onError:this.onDealerError})},getShortcuts:function(){return{esc:this.onClose,enter:this.handlePrimaryButtonClicked}},onClose:function(){this.getEditorAPI().panelManager.closePanelByName(this.props.panelName)},shouldPresentDealer:function(){return this.props.dealerViewer&&!this.state.hasDealerFailed},getFrameProps:function(){return{panelName:this.props.panelName,shouldHideHeader:!0}},getInnerContentClass:function(){if(this.props.contentPanelType===l.EMPTY)return null;switch(this.props.contentPanelType.name){case l.SHOUTOUT.name:return"grow-business-inner-panel";case l.CONNECT_DOMAIN.name:return"connect-domain-inner-panel";case l.GROW_BUSINESS.name:return"grow-business-inner-panel";default:return""}},getFrameClass:function(){var e="publish-success-panel save-publish-panel",t=this.getInnerContentClass();return e+=t?" contains-"+t:"",e+=this.shouldPresentDealer()&&!this.state.hasDealerSucceeded?" hide-panel-before-dealer-loaded":""},getPanelFrameClassName:function(){return"save-publish-panel-frame "+(this.shouldPresentDealer()&&!this.state.hasDealerSucceeded?"hide-panel-before-dealer-loaded":"")},onDoneAndBI:function(e){this.sendActionButtonClickedBI(e),this.onDone()},onDone:function(){if(this.state.dontShowAgain||this.props.isFakePanel){var e=this.state.dontShowAgain;this.props.setDontShowPanelValue(e)}this.props.closePanel()},isDontShowAgainCheckboxVisible:function(){return!this.props.configuration.isFirstPublish&&!i.isEqual(this.props.contentPanelType,l.EMPTY)},isSecondaryButtonDisplayed:function(){return S.isOpen("publishUpgradeButtons")&&!this.props.configuration.isDomainConnected&&this.props.contentPanelType.name===l.CONNECT_DOMAIN.name},viewYourSite:function(){this.sendViewSiteBI();var e=this.getEditorAPI().site.getSitePublicUrl();this.props.configuration.isDomainConnected&&(e=this.props.configuration.sitePremiumDomain),window.open(e)},getSiteUrl:function(){var e=this.getEditorAPI(),t=e.store.getState(),s=_.getSiteProtocol(t,e.dsRead),n=_.isDomainConnected(t,e.dsRead);return(this.props.configuration.sitePremiumDomain||this.props.sitePublicUrl).replace(/(?:^https?:\/\/)?(?:www\.)?(.*)/i,s+(n?"://www.$1":"://$1"))},sendDealerBI:function(e,t){this.sendBI(h.events.dealer.content_presented_by_dealer,{description:t,content_presented_by_dealer:e,stage:"render",category:"upgrade",panel_name:this.props.panelName}),this.sendPanelDisplayedBI(e)},onDealerDisplay:function(){this.setState({hasDealerSucceeded:!0}),o.dealerUtils.clearDealerRenderSuccessTimeout(this.renderTimeout),this.sendDealerBI(!0,""),o.fedopsLogger.interactionEnded(o.fedopsLogger.INTERACTIONS.DEALER_IN_POST_PUBLISH)},onDealerError:function(e){var t="dealer after pre fetch "+i.get(e,"errorType","")+" error";o.ravenUtils.sendMessage(t,o.ravenUtils.LOG_LEVEL.WARNING),this.sendDealerBI(!1,t),this.setState({hasDealerFailed:!0})},getInnerPanel:function(){var e=this.props.contentPanelType.name,t=null,s=null;if(this.shouldPresentDealer())t=this.props.dealerViewer,s=this.state.dealerViewerProps;else switch(e){case l.SHOUTOUT.name:t=c,s=this.getShoutoutPanelProps();break;case l.CONNECT_DOMAIN.name:t=p,s=this.getConnectDomainPanelProps(this.props.configuration);break;case l.GROW_BUSINESS.name:t=u,s={metaSiteId:this.getEditorAPI().dsRead.generalInfo.getMetaSiteId(),userStatus:this.getUserStatus(),isFirstPublish:this.props.configuration.isFirstPublish}}return t?n.createElement(t,s):null},getShoutoutPanelProps:function(){var e=this.getEditorAPI();return{isUserPremium:this.props.configuration.isPremiumUser,languageCode:o.languages.getLanguageCode(),metaSiteId:e.dsRead.generalInfo.getMetaSiteId(),sitePublicUrl:this.props.sitePublicUrl,siteNameSEO:e.dsRead.seo.title.get(),siteDescriptionSEO:e.dsRead.seo.description.get(),userStatus:this.getUserStatus(),isFirstPublish:this.props.configuration.isFirstPublish}},getConnectDomainPanelProps:function(e){return{isFirstPublish:e.isFirstPublish,isDomainConnected:e.isDomainConnected,currentDomain:this.props.sitePublicUrl,sitePublishedDomain:e.sitePremiumDomain,isSitePremium:e.isPremiumUser,isFirstSave:e.isFirstSave,closePanel:this.onDone,flowId:m.CONNECT_DOMAIN.FLOWS.PUBLISH,actionCallback:this.sendConnectDomainClickedBI}},getPrimaryButtonText:function(){return this.isSecondaryButtonDisplayed()?this.props.configuration.isPremiumUser?"Save_Publish_POST_CONNECT_NOW":(S.isOpen("spanishUpgradeText"),"Save_Publish_POST_UPGRADE_NOW"):"SAVE_PUBLISH_BUTTON_DONE"},getSecondaryButtonText:function(){return"Save_Publish_POST_CONNECT_LATER"},handlePrimaryButtonClicked:function(){var e=this.props.configuration.isFirstPublish,t=h.events.publish,s=e?t.First_Publish_Done_click:t.Second_Publish_Done_click;if(this.isSecondaryButtonDisplayed())if(this.isConnectDomainInProgress())this.openConnectDomainInProgressPanel(),s=t.publish_flow_connect_domain_now_button_click;else if(this.props.configuration.isPremiumUser)this.getEditorAPI().account.openConnectDomain(m.CONNECT_DOMAIN.FLOWS.PUBLISH_BUTTON,e),s=t.publish_flow_connect_domain_now_button_click;else{var n="edhtml_PUBLISH_FLOW_UPGRADE_BUTTON_"+(e?"FIRST_PUBLISH":"SECOND_PUBLISH");this.getEditorAPI().account.upgrade(n),s=t.publish_flow_upgrade_now_button_click}this.onDoneAndBI(s)},handleSecondaryButtonClicked:function(){var e=this.props.configuration.isFirstPublish,t=h.events.publish,s=e?t.First_Publish_Done_click:t.Second_Publish_Done_click;this.isSecondaryButtonDisplayed()&&(s=this.props.configuration.isPremiumUser?t.publish_flow_connect_domain_later_button_click:t.publish_flow_upgrade_later_button_click),this.onDoneAndBI(s)},isConnectDomainInProgress:function(){var e=this.props.configuration.sitePremiumDomain,t=this.props.configuration.isDomainConnected,s=this.props.configuration.isPremiumUser,n=!i.isEmpty(e)&&!i.includes(e,"wix.com");return s&&n&&!t},openConnectDomainInProgressPanel:function(){this.getEditorAPI().panelManager.openPanel("savePublish.panels.connectDomainInProgress",{connectedDomainURL:this.props.configuration.sitePremiumDomain,currentPublicURL:this.props.sitePublicUrl},!0)},sendPanelDisplayedBI:function(e){var t=h.events.publish.publish_success_panel_opened_with_content,s={is_first_publish:this.props.configuration.isFirstPublish,message:e?"DEALER":this.props.contentPanelType.name,type:e?"DEALER":"EDITOR"};this.sendBI(t,s)},sendConnectDomainClickedBI:function(){var e=null,t=null;e=this.props.configuration.isFirstPublish?h.events.publish.First_Publish_connect_domain_click:h.events.publish.Second_Publish_connect_domain_click,this.props.configuration.isSitePremium&&!this.props.configuration.isDomainConnected?t={user_status:"Not Connected Premium"}:this.props.configuration.isSitePremium||(t={user_status:"free user"}),e.fields.message&&(t.message=this.props.contentPanelType.name),e&&t&&this.sendBI(e,t)},sendActionButtonClickedBI:function(e){var t=this.props.configuration.isFirstPublish,s={user_status:this.getUserStatus()};e.fields.is_first_publish&&(s.is_first_publish=t),e.fields.message&&(s.message=this.props.contentPanelType.name),this.sendBI(e,s)},sendViewSiteBI:function(){this.sendBI(h.events.publish.publish_view_your_site_click,{is_first_publish:this.props.configuration.isFirstPublish?1:0,panel_name:"savePublish.panels.publish.publishSuccessPanel",user_status:this.getUserStatus()})},getUserStatus:function(){var e=this.props.configuration.isPremiumUser,t=this.props.configuration.isDomainConnected,s=null;return e?e&&t?s="Connected Premium":e&&!t&&(s="Not Connected Premium"):s="free user",s},toggleDontShowAgain:function(){var e=!this.state.dontShowAgain;this.sendToggleDontShowAgainBI(e),this.setState({dontShowAgain:e})},sendToggleDontShowAgainBI:function(e){e=e?1:0,this.props.configuration.isFirstPublish?this.sendBI(h.events.publish.First_Publish_dont_show_again_click,{toggle:e,user_status:this.getUserStatus()}):this.sendBI(h.events.publish.Second_Publish_dont_show_again_click,{toggle:e})},domainInputBiReporter:function(e){var t={user_status:this.getUserStatus(),panel_name:this.props.panelName,save_or_publish:"publish",is_first_save_or_publish:this.props.configuration.isFirstPublish?1:0};this.sendBI(h.events.domainInput[e],t)},sendBI:function(e,t){this.getEditorAPI().bi.event(e,t)},render:d})}),define("savePublish/panels/publish/publishPanels",["savePublish/panels/publish/config/publishConfigurationPanel","savePublish/panels/publish/publishSuccessPanel","savePublish/panels/publish/content/shoutoutPanel"],function(e,t,s){"use strict";return{config:{publishConfigurationPanel:e},publishSuccessPanel:t,shoutOut:s}}),define("savePublish",["lodash","savePublish/managers/saveManagerWrapper","savePublish/managers/autosaveManager","savePublish/managers/mockSaveManager","savePublish/managers/publishManager","savePublish/panels/connectDomain/connectDomainPanel","savePublish/panels/connectDomain/connectDomainInProgress","savePublish/panels/common/commonPanels","savePublish/panels/save/savePanels","savePublish/panels/publish/publishPanels"],function(e,t,s,n,i,a,o,r,l,c){"use strict";return{createSaveManager:t,createPublishManager:i,createAutosaveManager:s,configureSave:n.save,panels:{connectDomain:a,connectDomainInProgress:o,common:r,publish:c,save:l}}});
//# sourceMappingURL=savePublish.min.js.map